<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>five-a-side: Premier League Quiz</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet"
    />
    <style>
      /* Animations */
      .fade-in {
        animation: fadeIn 0.5s;
      }
      .fade-out {
        animation: fadeOut 0.5s;
      }
      .slide-in {
        animation: slideIn 0.5s;
      }
      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }
      @keyframes fadeOut {
        from {
          opacity: 1;
        }
        to {
          opacity: 0;
        }
      }
      @keyframes slideIn {
        from {
          transform: translateY(-20px);
          opacity: 0;
        }
        to {
          transform: translateY(0);
          opacity: 1;
        }
      }
      .pulse {
        animation: pulse 1s infinite;
      }
      @keyframes pulse {
        0% {
          opacity: 1;
        }
        50% {
          opacity: 0.5;
        }
        100% {
          opacity: 1;
        }
      }
      .blur-background {
        filter: blur(4px);
      }

      .carousel-container {
        position: relative;
        width: 100%;
        max-width: 400px;
        margin: auto;
        padding: 0 40px;
      }
      .carousel-content {
        max-width: 100%;
        margin: 0 auto;
        min-height: 200px;
        display: flex;
        flex-direction: column;
        justify-content: flex-start;
        align-items: center;
      }

      .carousel-arrow {
        font-size: 2rem;
        color: #fff;
        cursor: pointer;
        user-select: none;
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
      }

      .carousel-arrow:hover {
        color: #fbbf24;
      }

      #prev-btn {
        left: 0;
      }

      #next-btn {
        right: 0;
      }
      .instruction-title {
        font-weight: bold;
        font-size: 1.5rem;
        margin-top: 1rem;
        padding: 0.5rem;
        border-radius: 0.25rem;
        text-align: center;
        width: 100%;
      }
      .instruction-text-container {
        width: 100%;
        height: 120px;
        overflow-y: auto;
        margin-top: 1rem;
      }
      .instruction-text {
        text-align: center;
        font-size: 1rem;
        line-height: 1.5;
      }
      .bg-yellow-500 {
        background-color: #fbbf24;
      }
      .bg-purple-600 {
        background-color: #9f7aea;
      }
      .bg-green-700 {
        background-color: #047857;
      }
      .bg-blue-700 {
        background-color: #1d4ed8;
      }
      .bg-red-700 {
        background-color: #b91c1c;
      }

      /* New styles for mobile buttons */
      @media (max-width: 991px) {
        #mobile-buttons {
          display: grid;
        }
        #view-high-scores-btn,
        #how-to-play-btn-desktop {
          display: none;
        }
      }

      @media (min-width: 992px) {
        #mobile-buttons {
          display: none;
        }
        #view-high-scores-btn,
        #how-to-play-btn-desktop {
          display: block;
        }
      }

      /* Responsive text styles */
      @media (max-width: 640px) {
        .instruction-title {
          font-size: 1.25rem;
        }
        .instruction-text {
          font-size: 0.875rem;
        }
        .carousel-arrow {
          font-size: 1.5rem;
        }
      }

      @media (max-width: 480px) {
        .instruction-title {
          font-size: 1rem;
        }
        .instruction-text {
          font-size: 0.75rem;
        }
        .carousel-arrow {
          font-size: 1.25rem;
        }
        .carousel-container {
          padding: 0 30px;
        }
      }
    </style>
  </head>
  <body
    class="bg-gray-900 min-h-screen flex items-center justify-center p-2 font-poppins text-gray-100 text-base sm:text-lg touch-manipulation"
  >
    <div
      id="game-container"
      class="bg-gray-800 rounded-2xl shadow-xl p-4 w-full max-w-xl sm:max-w-2xl md:max-w-3xl lg:max-w-4xl space-y-4 relative"
    >
      <div class="absolute top-4 right-4 flex space-x-2">
        <button
          id="view-high-scores-btn"
          class="bg-gray-700 hover:bg-gray-600 font-bold text-xs sm:text-sm py-2 px-2 sm:py-2 sm:px-4 rounded-lg transition duration-300 text-white"
        >
          League Table
        </button>
        <button
          id="how-to-play-btn-desktop"
          class="bg-gray-700 hover:bg-gray-600 font-bold text-xs sm:text-sm py-2 px-2 sm:py-2 sm:px-4 rounded-lg transition duration-300 text-white"
        >
          How to play
        </button>
      </div>

      <h1 class="text-5xl sm:text-5xl font-bold text-center text-white">
        five-a-side
      </h1>
      <div
        id="round-info"
        class="text-yellow-500 text-lg sm:text-xl font-semibold text-center mt-2 mb-4"
      ></div>
      <div id="letter-grid" class="mb-4"></div>
      <div id="mobile-buttons" class="grid grid-cols-2 gap-2 mt-4">
        <button
          id="view-high-scores-btn-mobile"
          class="bg-gray-700 hover:bg-gray-600 font-bold text-xs py-2 px-2 rounded-lg transition duration-300 text-white"
        >
          League Table
        </button>
        <button
          id="how-to-play-btn-mobile"
          class="bg-gray-700 hover:bg-gray-600 font-bold text-xs py-2 px-2 rounded-lg transition duration-300 text-white"
        >
          How to Play
        </button>
      </div>
      <div
        id="starting-lineup"
        class="text-center text-lg sm:text-xl font-semibold mb-4 hidden"
      >
        Your starting lineup:
      </div>
      <div id="game-info-section" class="hidden">
        <div
          id="timer-container"
          class="w-full bg-gray-700 rounded-full h-2 sm:h-3 mb-2 sm:mb-4"
        >
          <div
            id="timer-bar"
            class="bg-red-700 h-2 sm:h-3 rounded-full transition-all duration-1000 ease-linear"
            style="width: 100%"
          ></div>
        </div>
        <div
          id="game-info"
          class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-6 gap-2 mb-4"
        >
          <div
            id="timer"
            class="bg-red-700 rounded-lg p-2 text-center font-bold text-sm sm:text-base text-white"
          >
            Time: 45s
          </div>
          <div
            id="guesses"
            class="bg-green-700 rounded-lg p-2 text-center font-bold text-sm sm:text-base text-white"
          >
            Guesses: 3
          </div>
          <div
            id="passes"
            class="bg-blue-700 rounded-lg p-2 text-center font-bold text-sm sm:text-base text-white"
          >
            Passes: 5
          </div>
          <div
            id="substitutions"
            class="bg-yellow-500 rounded-lg p-2 text-center font-bold text-sm sm:text-base text-gray-900"
          >
            Subs: 5
          </div>
          <div
            id="var-hints"
            class="bg-purple-600 rounded-lg p-2 text-center font-bold text-sm sm:text-base text-white"
          >
            VAR: 1
          </div>
          <div
            id="score"
            class="bg-gray-700 rounded-lg p-2 text-center font-bold text-sm sm:text-base text-white"
          >
            Points: 0
          </div>
        </div>
      </div>
      <div
        id="player-card"
        class="bg-gray-700 rounded-lg p-4 mb-4 shadow-inner hidden"
      >
        <div
          id="player-name"
          class="text-2xl sm:text-3xl font-bold text-center tracking-wider h-10 sm:h-12 font-mono"
        ></div>
      </div>
      <div
        id="current-team"
        class="text-center text-sm sm:text-base font-semibold mb-2 hidden"
      >
        Your current team:
      </div>
      <div id="game-controls" class="hidden justify-center space-x-2 mb-4">
        <button
          id="guess"
          class="bg-green-700 hover:bg-green-800 font-bold py-3 px-4 rounded-lg transition duration-300 text-sm sm:text-base flex-1 text-white"
        >
          Guess
        </button>
        <button
          id="pass"
          class="bg-blue-700 hover:bg-blue-800 font-bold py-3 px-4 rounded-lg transition duration-300 text-sm sm:text-base flex-1 text-white"
        >
          Pass
        </button>
        <button
          id="substitute"
          class="bg-yellow-500 hover:bg-yellow-600 font-bold py-3 px-4 rounded-lg transition duration-300 text-sm sm:text-base flex-1 text-gray-900"
        >
          Substitutions
        </button>
        <button
          id="var"
          class="bg-purple-600 hover:bg-purple-700 font-bold py-3 px-4 rounded-lg transition duration-300 text-sm sm:text-base flex-1 text-white"
        >
          VAR
        </button>
      </div>
      <button
        id="start-game"
        class="hidden w-full bg-red-700 hover:bg-red-800 font-bold py-3 px-4 rounded-lg transition duration-300 text-lg sm:text-xl text-white"
      >
        Start Game
      </button>
      <button
        id="new-game"
        class="hidden w-full bg-red-700 hover:bg-red-800 font-bold py-3 px-4 rounded-lg transition duration-300 text-lg sm:text-xl text-white"
      >
        New Game
      </button>
    </div>
    <!-- Updated Modals -->
    <div
      id="nameModal"
      class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center"
    >
      <div class="bg-gray-800 rounded-lg p-6 max-w-md w-full mx-4 sm:mx-auto">
        <h2 class="text-2xl font-bold text-center text-white mb-4">
          Welcome to five-a-side!
        </h2>
        <p class="text-center text-white mb-4">
          Enter your name to start playing
        </p>
        <input
          type="text"
          id="nameInput"
          class="w-full p-2 bg-gray-700 border border-gray-600 rounded-lg mb-4 text-white"
          placeholder="Your name"
        />
        <button
          id="saveNameBtn"
          class="w-full bg-blue-600 hover:bg-blue-700 font-bold py-2 px-4 rounded-lg transition duration-300 text-white"
        >
          Start Game
        </button>
      </div>
    </div>

    <div
      id="substituteModal"
      class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center"
    >
      <div class="bg-gray-800 rounded-lg p-4 max-w-md w-full mx-4 sm:mx-auto">
        <h2
          class="text-xl font-bold text-center justify-center items-center mb-3 text-white"
        >
          Make a change
        </h2>
        <div id="substitute-grid" class="mb-3"></div>
      </div>
    </div>

    <div
      id="guessModal"
      class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center"
    >
      <div class="bg-gray-800 rounded-lg p-4 max-w-sm w-full mx-4 sm:mx-auto">
        <h2 class="text-xl font-bold text-center mb-3 text-white">
          Guess the player name
        </h2>
        <div
          id="guess-timer"
          class="text-lg font-semibold text-center text-yellow-400 mb-3"
        >
          Time left: 10s
        </div>
        <input
          type="text"
          id="guess-input"
          placeholder="Enter player name"
          class="w-full p-2 bg-gray-700 border border-gray-600 rounded-lg mb-3 text-white"
        /><button
          id="submit-guess"
          class="w-full bg-green-700 hover:bg-green-800 font-bold py-2 px-4 rounded-lg transition duration-300 text-white"
        >
          Guess
        </button>
      </div>
    </div>

    <div
      id="varHintModal"
      class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center"
    >
      <div
        class="bg-gray-800 rounded-lg p-4 max-w-sm w-full mx-4 sm:mx-auto border-solid border-gray-600 border-4 shadow-lg"
      >
        <h2 class="text-xl font-bold text-center mb-3 text-white">Checking</h2>
        <div id="varHintText" class="text-lg text-center mb-3 text-white"></div>
        <button
          id="close-var-hint"
          class="w-full bg-purple-600 hover:bg-purple-700 font-bold py-2 px-4 rounded-lg transition duration-300 text-white"
        >
          Check complete
        </button>
      </div>
    </div>

    <div
      id="guess-popup"
      class="fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-yellow-500 p-3 rounded-lg shadow-lg text-center hidden text-gray-900"
    ></div>

    <div
      id="instructionsModal"
      class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center"
    >
      <div class="bg-gray-800 rounded-lg p-6 max-w-md w-full mx-4 sm:mx-auto">
        <h2 class="text-xl font-bold text-center text-white mb-4">
          How to play
        </h2>
        <div class="carousel-container">
          <span id="prev-btn" class="material-icons carousel-arrow"
            >chevron_left</span
          >
          <div class="carousel-content">
            <div class="carousel-item active">
              <div class="carousel-content">
                <p class="instruction-title bg-white text-gray-900">
                  Choose Letters
                </p>
                <div class="instruction-text-container">
                  <p class="instruction-text text-left">
                    <strong
                      >Select 1 vowel and 4 consonants for your starting lineup.
                    </strong>
                  </p>
                </div>
              </div>
            </div>
            <div class="carousel-item">
              <div class="carousel-content">
                <p class="instruction-title bg-red-600">Guess the Player</p>
                <div class="instruction-text-container">
                  <p class="instruction-text text-left">
                    <strong
                      >Try to guess as many players as you can in each round
                      using your chosen letters. You get 1 point for each
                      correct guess in rounds 1 and 2, and 3 points in round
                      3.</strong
                    >
                  </p>
                </div>
              </div>
            </div>
            <div class="carousel-item">
              <div class="carousel-content">
                <p class="instruction-title bg-yellow-500 text-gray-900">
                  Substitutions
                </p>
                <div class="instruction-text-container">
                  <p class="instruction-text text-left">
                    <strong
                      >You can make up to 5 substitutions throughout the game.
                      Vowels can only be substituted for vowels, and consonants
                      for consonants</strong
                    >
                  </p>
                </div>
              </div>
            </div>
            <div class="carousel-item">
              <div class="carousel-content">
                <p class="instruction-title bg-blue-700">Passes</p>
                <div class="instruction-text-container">
                  <p class="instruction-text text-left">
                    <strong
                      >If you're unsure, you can pass and move on to the next
                      player. You get 5 passes per game</strong
                    >
                  </p>
                </div>
              </div>
            </div>
            <div class="carousel-item">
              <div class="carousel-content">
                <p class="instruction-title bg-green-700">Guesses</p>
                <div class="instruction-text-container">
                  <p class="instruction-text text-left">
                    <strong
                      >You get 3 guesses per game to try and identify the
                      player. The game ends after 3 wrong guesses. You only get
                      one guess at each player</strong
                    >
                  </p>
                </div>
              </div>
            </div>
            <div class="carousel-item">
              <div class="carousel-content">
                <p class="instruction-title bg-purple-600">VAR</p>
                <div class="instruction-text-container">
                  <p class="instruction-text text-left">
                    <strong>
                      You can go to VAR 5 times per game to get a hint about the
                      player's identity</strong
                    >
                  </p>
                </div>
              </div>
            </div>
            <div class="carousel-item">
              <div class="carousel-content">
                <p class="instruction-title bg-gray-900">Rounds</p>
                <div class="instruction-text-container">
                  <p class="instruction-text text-left">
                    <strong
                      >There are 3 rounds in total. Round 1 and 2 last 45
                      seconds, and round 3 lasts 30 seconds. (unless you get 3
                      guesses wrong)</strong
                    >
                  </p>
                </div>
              </div>
            </div>
            <div class="carousel-item">
              <div class="carousel-content">
                <p class="instruction-title bg-teal-700">Think Tactically</p>
                <div class="instruction-text-container">
                  <p class="instruction-text text-left">
                    <strong>
                      The idea is to score as many points as possible across the
                      3 rounds. Use the substitutions, passes, guesses and VAR
                      strategically to maximize your score</strong
                    >
                  </p>
                </div>
              </div>
            </div>
          </div>
          <span id="next-btn" class="material-icons carousel-arrow"
            >chevron_right</span
          >
        </div>
        <button
          id="close-instructions"
          class="w-full mt-8 bg-gray-700 hover:bg-gray-600 font-bold py-2 px-4 rounded-lg transition duration-300 text-white"
        >
          Got it!
        </button>
      </div>
    </div>

    <!-- Updated High Scores Modal -->
    <div
      id="highScoresModal"
      class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center"
    >
      <div class="bg-gray-800 rounded-lg p-6 max-w-md w-full mx-4 sm:mx-auto">
        <h2 class="text-xl font-bold text-center text-white mb-4">
          five-a-side League Table
        </h2>
        <table class="w-full mb-4">
          <thead>
            <tr>
              <th class="text-left text-white">Position</th>
              <th class="text-left text-white">Name</th>
              <th class="text-left text-white">Points</th>
            </tr>
          </thead>
          <tbody id="highScoresTableBody"></tbody>
        </table>
        <button
          id="clear-high-scores"
          class="w-full bg-gray-700 hover:bg-gray-600 font-bold py-2 px-4 rounded-lg transition duration-300 text-white mb-2"
        >
          Start new season (clear scores)
        </button>
        <button
          id="close-high-scores"
          class="w-full bg-green-600 hover:bg-green-700 font-bold py-2 px-4 rounded-lg transition duration-300 text-white"
        >
          Close
        </button>
      </div>
    </div>

    <script>
      // Error logging function
      function logError(error, context) {
        console.error(`Error in ${context}:`, error);
        // In a production environment, you might want to send this to a server
        // or a third-party error tracking service
      }

      const VOWELS = ["A", "E", "I", "O", "U"];
      const SUBSTITUTION_COLORS = [
        "bg-red-600",
        "bg-yellow-600",
        "bg-purple-600",
        "bg-blue-600",
        "bg-green-600",
      ];

      class GameState {
        constructor() {
          this.reset();
        }

        reset() {
          this.chosenLetters = [];
          this.availableLetters = "ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");
          this.currentPlayer = "";
          this.displayedName = "";
          this.score = 0;
          this.substitutionsLeft = 5;
          this.passesLeft = 5;
          this.varHintsLeft = 5;
          this.timeLeft = 45;
          this.currentRound = 0;
          this.timerInterval = null;
          this.usedPlayers = { 1: [], 2: [], 3: [] }; // Changed this line
          this.usedLetters = new Set();
          this.pendingSubstitutions = {};
          this.allChosenLetters = new Set();
          this.vowelCount = 0;
          this.substitutionColorMap = {};
          this.wrongGuesses = 0;
          this.substitutionTimeoutCount = 0;
          this.isGameOver = false;
        }
      }

      const gameState = new GameState();

      const playerList = {
        modernPlayers: [
          {
            name: "ERLING HAALAND",
            hint: "Norwegian striker who broke the Premier League scoring record in his debut season",
          },
          {
            name: "KEVIN DE BRUYNE",
            hint: "Belgian midfielder who plays for Manchester City known for his exceptional passing and vision",
          },
          {
            name: "MOHAMED SALAH",
            hint: "Egyptian winger who won the Premier League Golden Boot three times",
          },
          {
            name: "BRUNO FERNANDES",
            hint: "Portuguese midfielder who quickly became a key player for Manchester United after joining from Sporting CP",
          },
          {
            name: "MARCUS RASHFORD",
            hint: "English forward who came through Manchester United's academy scored on his debut against Arsenal",
          },
          {
            name: "JACK GREALISH",
            hint: "English midfielder with a record-breaking transfer fee to Manchester City from Aston Villa",
          },
          {
            name: "BUKAYO SAKA",
            hint: "Young English winger who emerged from Arsenal's academy",
          },
          {
            name: "VIRGIL VAN DIJK",
            hint: "Liverpool's Dutch center-back considered one of the best defenders in the world",
          },
          {
            name: "HEUNG MIN SON",
            hint: "South Korean forward who won the Premier League Golden Boot in 2021-22",
          },
          {
            name: "RAHEEM STERLING",
            hint: "English winger who has played for Liverpool, Manchester City, and Chelsea",
          },
          {
            name: "PHIL FODEN",
            hint: "Young English midfielder dubbed the 'Stockport Iniesta'",
          },
          {
            name: "GABRIEL JESUS",
            hint: "Brazilian forward who moved from Manchester City to Arsenal",
          },
          {
            name: "RUBEN DIAS",
            hint: "Portuguese defender who won the FWA Footballer of the Year in his debut Premier League season",
          },
          {
            name: "ANDY ROBERTSON",
            hint: "Scottish left-back known for his consistent performances and assists",
          },
          {
            name: "THIAGO SILVA",
            hint: "Brazilian center-back who joined Chelsea late in his career",
          },
          {
            name: "MASON MOUNT",
            hint: "English midfielder who came through Chelsea's academy and now plays for Manchester United",
          },
          {
            name: "DECLAN RICE",
            hint: "English defensive midfielder who captained West Ham before a big move to Arsenal",
          },
          {
            name: "JAMES MADDISON",
            hint: "English attacking midfielder known for his creativity and set-pieces. Moved from Leicester to Tottenham",
          },
          {
            name: "IVAN TONEY",
            hint: "English striker who had a remarkable rise from lower leagues to the Premier League. Loves a bet",
          },
          {
            name: "CALLUM WILSON",
            hint: "Newcastle striker who joined from Bournemouth.",
          },
          {
            name: "KIERAN TRIPPIER",
            hint: "English right-back who returned to the Premier League after a spell in Spain with Atletico Madrid",
          },
          {
            name: "OLLIE WATKINS",
            hint: "Aston Villa striker who made the jump from Championship to Premier League after joining from Brentford",
          },
          {
            name: "JAMES WARD-PROWSE",
            hint: "English midfielder renowned for his exceptional free-kick ability. Moved from Southampton to West Ham",
          },
          {
            name: "GABRIEL MARTINELLI",
            hint: "Brazilian winger who joined Arsenal as a teenager",
          },
          {
            name: "MARTIN ODEGAARD",
            hint: "Norwegian midfielder who became Arsenal's youngest captain after joining from Real Madrid",
          },
          {
            name: "REECE JAMES",
            hint: "English right-back who emerged from Chelsea's academy",
          },
          {
            name: "RODRI",
            hint: "Spanish defensive midfielder who replaced Fernandinho at Manchester City",
          },
          {
            name: "BERNARDO SILVA",
            hint: "Manchester City's Portuguese midfielder known for his technical skills and work rate",
          },
          {
            name: "EDERSON",
            hint: "Brazilian goalkeeper known for his distribution skills",
          },
          {
            name: "ALISSON BECKER",
            hint: "Brazilian goalkeeper who scored a crucial header for Liverpool",
          },
          {
            name: "ANTHONY GORDON",
            hint: "English winger who moved from Everton to Newcastle United.",
          },
          {
            name: "COLE PALMER",
            hint: "Young English forward who had a great first season at Chelsea after joining from Manchester City",
          },
          {
            name: "JOHN MCGINN",
            hint: "Scottish midfielder who helped Aston Villa return to the Premier League. ",
          },
          {
            name: "WILLIAM SALIBA",
            hint: "French defender who had to wait for his Arsenal debut",
          },
          {
            name: "DOMINIC SOLANKE",
            hint: "English striker who found his form after moving to Bournemouth from Liverpool",
          },
          {
            name: "ALEXANDER ISAK",
            hint: "Swedish striker who became Newcastle's record signing after impressing at Real Sociedad",
          },
          {
            name: "JARROD BOWEN",
            hint: "English winger who made the jump from Championship to Premier League with West Ham",
          },
          {
            name: "PEDRO NETO",
            hint: "Portuguese winger who became a key player for Wolves",
          },
          {
            name: "DAVID RAYA",
            hint: "Spanish goalkeeper who joined Arsenal from Brentford",
          },
          {
            name: "MATTY CASH",
            hint: "English right-back who plays for Poland. joined Aston Villa from Nottingham Forest",
          },
          {
            name: "JULIAN ALVAREZ",
            hint: "Argentine forward who won the World Cup before his first full Premier League season end with a treble",
          },
          {
            name: "DARWIN NUNEZ",
            hint: "Uruguayan striker who joined Liverpool for a club-record fee from Benfica",
          },
          {
            name: "JAMES TARKOWSKI",
            hint: "English defender who was a mainstay for Burnley before joining Everton",
          },
          {
            name: "RICHARLISON",
            hint: "Brazilian forward who played for Watford and Everton before joining Tottenham",
          },
          {
            name: "CURTIS JONES",
            hint: "English midfielder who came through Liverpool's academy",
          },
          {
            name: "IBRAHIMA KONATE",
            hint: "French defender who joined Liverpool from RB Leipzig",
          },
          {
            name: "MOUSSA DIABY",
            hint: "French winger who joined Aston Villa from Bayer Leverkusen",
          },
          {
            name: "MICKY VAN DE VEN",
            hint: "Dutch defender who joined Tottenham and impressed with his speed",
          },
          {
            name: "KOSTAS TSIMIKAS",
            hint: "Greek left-back who joined Liverpool from Olympiacos",
          },

          {
            name: "MIGUEL ALMIRON",
            hint: "Paraguayan midfielder who became Newcastle's record signing from MLS",
          },
          {
            name: "HARRY MAGUIRE",
            hint: "English defender who became Manchester United's captain after joining from Leicester",
          },
          {
            name: "JACOB RAMSEY",
            hint: "English midfielder who broke into the Aston Villa first team",
          },
          {
            name: "YANKUBA MINTEH",
            hint: "Gambian who joined Brighton from Newcastle United after impressing at Feyenoord on loan",
          },
          {
            name: "KIERAN DEWSBURY-HALL",
            hint: "English midfielder who broke into the Leicester first team before joining Chelsea",
          },
          {
            name: "MORGAN GIBBS-WHITE",
            hint: "English midfielder who made a big-money move to Nottingham Forest",
          },
          {
            name: "PASCAL GROSS",
            hint: "German midfielder who has been crucial for Brighton since their promotion",
          },
          {
            name: "BRENNAN JOHNSON",
            hint: "Welsh forward who helped Nottingham Forest return to the Premier League. Now at Tottenham",
          },
          {
            name: "MAX KILMAN",
            hint: "Defender who joined West Ham from Wolves for 40 million pounds",
          },
          {
            name: "JOSHUA ZIRKZEE",
            hint: "Dutch striker who joined Manchester United from Bologna",
          },
          {
            name: "BEN WHITE",
            hint: "English defender who established himself at Arsenal for his versatility and tackling.",
          },
          {
            name: "OLEKSANDR ZINCHENKO",
            hint: "Ukrainian defender who joined Arsenal from Manchester City, known for his versatility and passing.",
          },
          {
            name: "LEON BAILEY",
            hint: "Jamaican winger who signed with Aston Villa from Bayer Leverkusen, known for his speed and dribbling.",
          },
          {
            name: "EMILIANO MARTINEZ",
            hint: "Argentinian goalkeeper who won the World Cup.",
          },
          {
            name: "MIKKEL DAMSGAARD",
            hint: "Danish midfielder who joined Brentford after impressing in the Euro 2020 tournament.",
          },
          {
            name: "NEAL MAUPAY",
            hint: "French forward who has played for Brentford, Brighton and Everton.",
          },
          {
            name: "CHRISTIAN NORGAARD",
            hint: "Danish midfielder who played a key role in Brentford's promotion to the Premier League.",
          },
          {
            name: "JOAO PEDRO",
            hint: "Brazilian forward who joined Brighton from Watford, known for his dribbling and goal-scoring.",
          },
          {
            name: "TARIQ LAMPTEY",
            hint: "English defender who moved to Brighton from Chelsea, known for his speed.",
          },
          {
            name: "SOLLY MARCH",
            hint: "English midfielder who became a regular starter for Brighton, known for his dribbling.",
          },
          {
            name: "KAORU MITOMA",
            hint: "Japanese forward who joined Brighton and impressed with his speed and dribbling.",
          },
          {
            name: "PERVIS ESTUPINAN",
            hint: "Ecuadorian defender who joined Brighton from Villarreal.",
          },
          {
            name: "JULIO ENCISO",
            hint: "Paraguayan forward plays for Brighton.",
          },
          {
            name: "EVAN FERGUSON",
            hint: "Irish forward who broke into the Brighton first team.",
          },
          {
            name: "BEN CHILWELL",
            hint: "English defender who joined Chelsea from Leicester.",
          },
          {
            name: "MARC CUCURELLA",
            hint: "Spanish defender who signed with Chelsea from Brighton.",
          },
          {
            name: "MALO GUSTO",
            hint: "French defender who joined Chelsea from Lyon.",
          },
          {
            name: "LEVI COLWILL",
            hint: "English defender who broke into the Chelsea first team.",
          },
          {
            name: "ENZO FERNANDEZ",
            hint: "Argentinian midfielder who joined Chelsea after winning the World Cup.",
          },
          {
            name: "ANTONY",
            hint: "Brazilian winger who joined Manchester United from Ajax.",
          },
          {
            name: "CONOR GALLAGHER",
            hint: "English midfielder who became a key player for Chelsea after returning from loan.",
          },
          {
            name: "MOISES CAICEDO",
            hint: "Ecuadorian midfielder who signed with Chelsea from Brighton for a British record fee.",
          },
          {
            name: "CHRISTOPHER NKUNKU",
            hint: "French forward who joined Chelsea from RB Leipzig.",
          },
          {
            name: "BERND LENO",
            hint: "German goalkeeper who joined Fulham from Arsenal.",
          },
          {
            name: "ANTONEE ROBINSON",
            hint: "American defender who plays for Fulham.",
          },
          {
            name: "ALEKSANDAR MITROVIC",
            hint: "Serbian forward who plays for Fulham, known for his fiery temper.",
          },
          {
            name: "LUCAS PAQUETA",
            hint: "Brazilian midfielder who joined West Ham United from Lyon.",
          },
          {
            name: "EBERECHI EZE",
            hint: "English midfielder who is a key player for Crystal Palace.",
          },
          {
            name: "DWIGHT MCNEIL",
            hint: "English winger who joined Everton from Burnley.",
          },
          {
            name: "MYKHAILO MUDRYK",
            hint: "Ukrainian winger who signed with Chelsea from Shakhtar Donetsk.",
          },
          {
            name: "CHEICK DOUCOURE",
            hint: "Malian midfielder who joined Crystal Palace from Lens.",
          },
          {
            name: "ODSONNE EDOUARD",
            hint: "French striker who plays for Crystal Palace.",
          },
          {
            name: "JAMES TOMKINS",
            hint: "English defender who has been a mainstay for Crystal Palace.",
          },
          {
            name: "AMADOU ONANA",
            hint: "Belgian midfielder who joined Everton from Lille.",
          },
          {
            name: "ANDRE ONANA",
            hint: "Cameroonian goalkeeper who joined Manchester United from Inter Milan.",
          },
          {
            name: "KURT ZOUMA",
            hint: "French defender who joined West Ham United from Chelsea. Volleyed a cat.",
          },
          {
            name: "JAMES GARNER",
            hint: "English midfielder who joined Everton from Manchester United.",
          },
          {
            name: "ALEXIS MAC ALLISTER",
            hint: "Argentinian midfielder who joined Liverpool from Brighton & Hove Albion.",
          },
          {
            name: "CODY GAKPO",
            hint: "Dutch forward who joined Liverpool from PSV Eindhoven.",
          },
          {
            name: "SANDRO TONALI",
            hint: "Italian midfielder who joined Newcastle United from AC Milan.",
          },
          {
            name: "HARVEY BARNES",
            hint: "English winger who joined Newcastle United from Leicester City.",
          },
          {
            name: "SVEN BOTMAN",
            hint: "Dutch defender who is a key player for Newcastle United.",
          },
          {
            name: "CRISTIAN ROMERO",
            hint: "Argentinian defender who is a key player for Tottenham Hotspur.",
          },
          {
            name: "DEJAN KULUSEVSKI",
            hint: "Swedish winger who joined Tottenham Hotspur from Juventus.",
          },
          {
            name: "RICO HENRY",
            hint: "English defender who plays for Brentford.",
          },
          {
            name: "WESLEY FOFANA",
            hint: "French defender who joined Chelsea from Leicester City.",
          },
        ],
        legendPlayers: [
          {
            name: "ALAN SHEARER",
            hint: "All-time top scorer in the Premier League. Played for Blackburn and Newcastle",
          },
          {
            name: "JAAP STAM",
            hint: "Dutch defender who was a key player for Manchester United in the 99 treble-winning season",
          },
          {
            name: "GIANLUCA VIALLI",
            hint: "Italian forward who played for Sampdoria, Juventus, and Chelsea",
          },
          {
            name: "THIERRY HENRY",
            hint: "French striker who was part of Arsenal's 'Invincibles'. Arsenal's all-time top scorer",
          },
          {
            name: "ERIC CANTONA",
            hint: "French forward known for his swagger and crucial role in Manchester United's success",
          },
          {
            name: "PHILIPPE COUTINHO",
            hint: "Brazilian midfielder who was a key player for Liverpool before joining Barcelona",
          },
          {
            name: "STEVEN GERRARD",
            hint: "Liverpool midfielder known for his long-range goals and leadership",
          },
          {
            name: "FRANK LAMPARD",
            hint: "Midfielder who became Chelsea's all-time top scorer",
          },
          {
            name: "RYAN GIGGS",
            hint: "Welsh winger who played for Manchester United for over two decades",
          },
          {
            name: "PATRICK VIEIRA",
            hint: "French midfielder who captained Arsenal during their 'Invincibles' season",
          },
          {
            name: "ROY KEANE",
            hint: "Irish midfielder known for his aggressive style and leadership at Manchester United",
          },
          {
            name: "PETER SCHMEICHEL",
            hint: "Danish goalkeeper who was crucial to Manchester United's success in the 90s",
          },
          {
            name: "DES WALKER",
            hint: "English defender known for his pace and strength. Played for Nottingham Forest and Sheffield Wednesday",
          },
          {
            name: "EMMANUEL PETIT",
            hint: "French midfielder who won the World Cup with France and played for Arsenal",
          },
          {
            name: "DAVID GINOLA",
            hint: "French winger known for his flair and skill. Played for Tottenham and Newcastle",
          },
          {
            name: "XABI ALONSO",
            hint: "Spanish midfielder known for his passing range and vision. Played for Liverpool and Real Madrid",
          },
          {
            name: "JOHN TERRY",
            hint: "Chelsea defender who captained the club to multiple Premier League titles",
          },
          {
            name: "RIO FERDINAND",
            hint: "English defender who formed a formidable partnership with Nemanja Vidic",
          },
          {
            name: "PAUL SCHOLES",
            hint: "Manchester United midfielder known for his passing range and shooting ability",
          },
          {
            name: "WAYNE ROONEY",
            hint: "Forward who became Manchester United and England's all-time top scorer",
          },
          {
            name: "DIDIER DROGBA",
            hint: "Ivorian striker known for his physicality and crucial goals for Chelsea",
          },
          {
            name: "DENNIS BERGKAMP",
            hint: "Dutch forward renowned for his technical skill and creativity. Known as the 'Non-Flying Dutchman'",
          },
          {
            name: "DAVID BECKHAM",
            hint: "English midfielder famous for his crossing and free-kick ability",
          },
          {
            name: "CRISTIANO RONALDO",
            hint: "Portuguese forward who won his first Ballon d'Or while at Manchester United",
          },
          {
            name: "VINCENT KOMPANY",
            hint: "Belgian defender who captained Manchester City to multiple titles",
          },
          {
            name: "ASHLEY COLE",
            hint: "English left-back considered one of the best in his position",
          },
          {
            name: "NEMANJA VIDIC",
            hint: "Serbian defender who formed a formidable partnership with Rio Ferdinand",
          },
          {
            name: "MICHAEL CARRICK",
            hint: "English midfielder who played for West Ham, Tottenham and Manchester United known for his passing and vision",
          },
          {
            name: "PETER CROUCH",
            hint: "English striker known for his height and 'robot' goal celebration",
          },
          {
            name: "IAN WRIGHT",
            hint: "English striker who was Arsenal's top scorer before being surpassed by Thierry Henry",
          },
          {
            name: "JAMIE CARRAGHER",
            hint: "Liverpool defender who spent his entire career with the club",
          },
          {
            name: "GARY NEVILLE",
            hint: "Manchester United right-back who was part of the 'Class of 92'",
          },
          {
            name: "MICHAEL OWEN",
            hint: "English striker who won the Ballon d'Or while at Liverpool",
          },
          {
            name: "ROBBIE FOWLER",
            hint: "Liverpool striker nicknamed 'God' by the club's fans",
          },
          {
            name: "SERGIO AGUERO",
            hint: "Argentinian striker who scored the most famous goal in Premier League history",
          },
          {
            name: "MATT LE TISSIER",
            hint: "Southampton midfielder known for his loyalty and spectacular goals",
          },
          {
            name: "GIANFRANCO ZOLA",
            hint: "Italian forward who became a Chelsea legend despite joining later in his career",
          },
          {
            name: "EMILE HESKEY",
            hint: "English striker who formed a successful partnership with Michael Owen",
          },
          {
            name: "JIMMY FLOYD HASSELBAINK",
            hint: "Dutch striker who was a prolific goalscorer for Leeds United and Chelsea",
          },
          {
            name: "DUNCAN FERGUSON",
            hint: "Scottish forward known for his physicality and aerial ability. Nicknamed 'Big Dunc'",
          },
          {
            name: "STAN COLLYMORE",
            hint: "English striker who played for Nottingham Forest, Liverpool, and Aston Villa",
          },
          {
            name: "PETER BEARDSLEY",
            hint: "English forward who played for Liverpool, Newcastle, and Everton",
          },
          {
            name: "JURGEN KLINSMANN",
            hint: "German forward who played for Tottenham and won the World Cup with Germany",
          },
          {
            name: "PAULO DI CANIO",
            hint: "Italian forward remembered for his spectacular goals and controversial moments",
          },
          {
            name: "RUUD VAN NISTELROOY",
            hint: "Dutch striker who was a prolific goalscorer for Manchester United",
          },
          {
            name: "EDWIN VAN DER SAR",
            hint: "Dutch goalkeeper who had a successful late career at Manchester United",
          },
          {
            name: "PETR CECH",
            hint: "Czech goalkeeper who holds the record for most clean sheets in the Premier League",
          },
          {
            name: "CLAUDE MAKELELE",
            hint: "French midfielder who defined the defensive midfield role",
          },
          {
            name: "ROBERT PIRES",
            hint: "French winger who was a key part of Arsenal's 'Invincibles'",
          },
          {
            name: "FREDDIE LJUNGBERG",
            hint: "Swedish midfielder who was part of Arsenal's 'Invincibles'",
          },
          {
            name: "SOL CAMPBELL",
            hint: "English defender who controversially moved from Tottenham to Arsenal",
          },
          {
            name: "ANDY COLE",
            hint: "English striker who is the third-highest goalscorer in Premier League history",
          },
          {
            name: "TEDDY SHERINGHAM",
            hint: "English forward who scored crucial goals for Manchester United in their treble-winning season",
          },
          {
            name: "LES FERDINAND",
            hint: "English striker nicknamed 'Sir Les' who played for several Premier League clubs",
          },
          {
            name: "TONY ADAMS",
            hint: "English defender who captained Arsenal to league titles in three different decades",
          },
          {
            name: "CHRIS SUTTON",
            hint: "Formed the famous 'SAS' strike partnership with Alan Shearer at Blackburn Rovers",
          },
          {
            name: "MARK VIDUKA",
            hint: "Captained Australia at the 2006 World Cup and scored 4 goals against Liverpool in a single match",
          },
          {
            name: "LUIS SUAREZ",
            hint: "Uruguayan striker who won the Premier League Golden Boot with Liverpool before moving to Barcelona",
          },
          {
            name: "SAMI HYYPIA",
            hint: "Finnish defender who captained Liverpool.",
          },
          {
            name: "MARCEL DESAILLY",
            hint: "The first player to win the UEFA Champions League with two different clubs",
          },
          {
            name: "LUCAS RADEBE",
            hint: "South African defender and Leeds United legend, nicknamed 'The Chief'",
          },
          {
            name: "GARY SPEED",
            hint: "The first player to reach 500 Premier League appearances. Played for Leeds United, Everton, Newcastle, and Bolton",
          },
          {
            name: "NIGEL MARTYN",
            hint: "The first £1 million goalkeeper in English football. Played for Crystal Palace, Leeds United, and Everton",
          },
          {
            name: "MATT ELLIOTT",
            hint: "Leicester City's captain during their League Cup triumphs in 1997 and 2000",
          },
          {
            name: "GARETH SOUTHGATE",
            hint: "England manager who played for Crystal Palace, Aston Villa, and Middlesbrough",
          },
          {
            name: "TIM FLOWERS",
            hint: "Blackburn Rovers goalkeeper who won the Premier League in 1995",
          },
          {
            name: "GARETH BALE",
            hint: "Welsh winger who won multiple Champions League titles with Real Madrid after leaving Tottenham",
          },
          {
            name: "GARY MCALLISTER",
            hint: "Scottish midfielder who won the treble with Liverpool in 2001. Scored the best goal ever against Everton",
          },
          {
            name: "NICOLAS ANELKA",
            hint: "French striker who played for Arsenal, Real Madrid, and Chelsea",
          },
          {
            name: "DIMITAR BERBATOV",
            hint: "Bulgarian striker who won the Premier League Golden Boot with Manchester United",
          },
          {
            name: "DION DUBLIN",
            hint: "The only player to have scored in the Premier League with 7 different clubs (Aston Villa, Coventry City, Manchester United, Millwall, Southampton, and Derby County)",
          },
          {
            name: "MARC OVERMARS",
            hint: "Dutch winger who won the Premier League and FA Cup with Arsenal",
          },
          {
            name: "ROBERTO DI MATTEO",
            hint: "Scored the fastest goal in FA Cup Final history after just 42 seconds for Chelsea",
          },
          {
            name: "DAVID BATTY",
            hint: "English midfield who was part of the Blackburn Rovers team that won the Premier League in 1995",
          },
          {
            name: "TONY YEBOAH",
            hint: "Scored a stunning volley against Wimbledon that won Goal of the Season in 1995-96",
          },
          {
            name: "LEDLEY KING",
            hint: "Tottenham Hotspur legend who played his entire career at the club",
          },
          {
            name: "FABRIZIO RAVANELLI",
            hint: "The 'White Feather' who scored a hat-trick on his Middlesbrough debut",
          },
          {
            name: "HARRY KEWELL",
            hint: "Australian winger who played for Leeds United and Liverpool",
          },
          {
            name: "JAY JAY OKOCHA",
            hint: "Nigerian midfielder known for his skill and flair at Bolton Wanderers",
          },
          {
            name: "JUNINHO",
            hint: "The diminutive Brazilian playmaker who became a Middlesbrough legend",
          },
          {
            name: "PATRIK BERGER",
            hint: "Czech midfielder who was part of the Liverpool team that won the treble in 2001",
          },
          {
            name: "DAVID JAMES",
            hint: "The goalkeeper with the most clean sheets in Premier League history (169)",
          },
          {
            name: "STEVE MCMANAMAN",
            hint: "Won two Champions Leagues and a La Liga title with Real Madrid after leaving Liverpool",
          },
          {
            name: "DAMIEN DUFF",
            hint: "Irish winger who played for Blackburn, Chelsea, and Newcastle in the Premier League",
          },
          {
            name: "ARJEN ROBBEN",
            hint: "Dutch winger who won two Premier League titles with Chelsea",
          },
          {
            name: "PATRICE EVRA",
            hint: "French left-back who won five Premier League titles with Manchester United",
          },
          {
            name: "PEPE REINA",
            hint: "Spanish goalkeeper who kept a record 134 clean sheets for Liverpool",
          },
          {
            name: "ROBIN VAN PERSIE",
            hint: "Dutch striker who won the Premier League with Manchester United in 2013 after leaving Arsenal",
          },
          {
            name: "LUKA MODRIC",
            hint: "Croatian midfielder who won the Ballon d'Or in 2018",
          },
          {
            name: "YAYA TOURE",
            hint: "Ivorian midfielder who won three Premier League titles with Manchester City",
          },
          {
            name: "RICARDO CARVALHO",
            hint: "Portuguese defender who won the Premier League with Chelsea",
          },
          {
            name: "CARLOS TEVEZ",
            hint: "Argentine striker who played for both Manchester United and Manchester City",
          },
          {
            name: "CESC FABREGAS",
            hint: "Spanish midfielder who started his career at Arsenal before moving to Barcelona and Chelsea",
          },
          {
            name: "NGOLO KANTE",
            hint: "French midfielder who won back-to-back Premier League titles with Leicester and Chelsea",
          },
          {
            name: "JAMIE VARDY",
            hint: "English striker who won the Premier League with Leicester City in 2016",
          },
          {
            name: "FERNANDINHO",
            hint: "Long-serving defensive midfielder for Manchester City who won multiple Premier League titles",
          },
          {
            name: "GILBERTO SILVA",
            hint: "Brazilian midfielder who was a key part of Arsenal's 'Invincibles'",
          },
          {
            name: "JAVIER MASCHERANO",
            hint: "Argentinian midfielder who played for West Ham and Liverpool",
          },
          {
            name: "FERNANDO TORRES",
            hint: "Spanish striker who won the World Cup and European Championship with Spain. Played for Liverpool and Chelsea",
          },
          {
            name: "KOLO TOURE",
            hint: "Ivorian defender who played for Arsenal and Manchester City",
          },
          {
            name: "GARETH BARRY",
            hint: "English midfielder who holds the record for most Premier League appearances",
          },
          {
            name: "MICHAEL BALLACK",
            hint: "German midfielder who played for Chelsea and Bayern Munich",
          },
          {
            name: "RIYAD MAHREZ",
            hint: "Algerian winger who won the Premier League with both Leicester City and Manchester City",
          },
          {
            name: "EDEN HAZARD",
            hint: "Belgian winger who won the Premier League Player of the Season award in 2015",
          },
          {
            name: "JUAN MATA",
            hint: "Spanish midfielder who has won the Champions League, Europa League, and FA Cup with Chelsea and Manchester United",
          },
          {
            name: "CESAR AZPILICUETA",
            hint: "Versatile Spanish defender who has captained Chelsea to multiple trophies including the Champions League",
          },
          {
            name: "MESUT OZIL",
            hint: "German playmaker who recorded 19 assists in a single Premier League season for Arsenal in 2015-16",
          },
          {
            name: "DAVID SILVA",
            hint: "Spanish midfielder who spent 10 successful years at Manchester City before joining Real Sociedad",
          },
          {
            name: "LEIGHTON BAINES",
            hint: "Long-serving Everton left-back known for his exceptional free-kick ability",
          },
          {
            name: "ROMELU LUKAKU",
            hint: "Belgian striker who has scored over 100 Premier League goals",
          },
          {
            name: "DIEGO COSTA",
            hint: "Controversial Spanish striker who won two Premier League titles with Chelsea",
          },
          {
            name: "JORDAN HENDERSON",
            hint: "Liverpool captain who lifted the Premier League trophy in 2020 after a 30-year wait",
          },
          {
            name: "SADIO MANE",
            hint: "Senegalese winger who won the Premier League with Liverpool in 2020 and the Champions League in 2019",
          },
          {
            name: "HARRY KANE",
            hint: "England captain and Tottenham's all-time leading goalscorer in the Premier League",
          },
          {
            name: "MICHAEL ESSIEN",
            hint: "Ghanaian midfielder known for his powerful long-range shots at Chelsea",
          },
        ],
        obscurePlayers: [
          {
            name: "DEAN HOLDSWORTH",
            hint: "English forward who formed a prolific strike partnership with Eidur Gudjohnsen at Bolton Wanderers",
          },
          {
            name: "ANDREI VORONIN",
            hint: "Ukrainian striker who played for Liverpool",
          },
          {
            name: "KIERAN RICHARDSON",
            hint: "English midfielder who played for Manchester United, West Brom and Sunderland",
          },
          {
            name: "MARCUS BENT",
            hint: "English striker who played for Ipswich Town, Charlton Athletic and Everton",
          },
          {
            name: "JASON EUELL",
            hint: "Jamaican striker who is Charlton Athletic's record goalscorer in the Premier League",
          },
          {
            name: "STEED MALBRANQUE",
            hint: "French midfielder who played for Fulham, Tottenham and Sunderland",
          },
          {
            name: "MOMO SISSOKO",
            hint: "Malian midfielder who played for Liverpool and Juventus",
          },
          {
            name: "SHOLA AMEOBI",
            hint: "Nigerian striker who played for Newcastle United",
          },
          {
            name: "YOUNES KABOUL",
            hint: "French defender who played for Tottenham Hotspur and Sunderland",
          },
          {
            name: "OLIVIER DACOURT",
            hint: "French midfielder who played for Leeds United and Everton",
          },
          {
            name: "SANDER WESTERVELD",
            hint: "Dutch goalkeeper who played for Liverpool in the early 2000s",
          },
          {
            name: "PAOLO WANCHOPE",
            hint: "Costa Rican striker who played for Derby County, West Ham, and Manchester City",
          },
          {
            name: "MUZZY IZZET",
            hint: "Turkish midfielder who formed a formidable partnership with Neil Lennon at Leicester City",
          },
          {
            name: "STAN LAZARIDIS",
            hint: "Australian winger known for his time at Birmingham City",
          },
          {
            name: "ALI DIA",
            hint: "Senegalese forward who famously played one game for Southampton",
          },
          {
            name: "ERIC DJEMBA-DJEMBA",
            hint: "Cameroonian midfielder who played for Manchester United",
          },
          {
            name: "JONAS GUTIERREZ",
            hint: "Argentinian winger who played for Newcastle United",
          },
          {
            name: "MARCELINO",
            hint: "Spanish defender who struggled with injuries at Newcastle United",
          },
          {
            name: "BOUDEWIJN ZENDEN",
            hint: "Dutch midfielder who played for Chelsea, Middlesbrough and Liverpool",
          },
          {
            name: "TOMASZ RADZINSKI",
            hint: "Canadian forward who played for Everton and Fulham",
          },
          {
            name: "PETER ODEMWINGIE",
            hint: "Nigerian forward who played for West Bromwich Albion. Infamously tried to force a move to QPR",
          },
          {
            name: "JULIANO BELLETTI",
            hint: "Brazilian defender who played for Chelsea",
          },
          {
            name: "JONAS OLSSON",
            hint: "Swedish defender who played for West Bromwich Albion",
          },
          {
            name: "JONAS LUNDE",
            hint: "Norwegian goalkeeper who played for Wimbledon",
          },
          {
            name: "IAN WOAN",
            hint: "English midfielder who played for Nottingham Forest",
          },
          {
            name: "ERIK EDMAN",
            hint: "Swedish defender who played for Tottenham Hotspur. Scored a famous goal against Liverpool",
          },
          {
            name: "ADEL TAARABT",
            hint: "Moroccan midfielder who played for Queens Park Rangers and Tottenham Hotspur",
          },
          {
            name: "DAVID DUNN",
            hint: "English midfielder who played for Blackburn Rovers and Birmingham City.",
          },
          {
            name: "ANTTI NIEMI",
            hint: "Finnish goalkeeper known for his time at Southampton",
          },
          {
            name: "CHRITIAN KAREMBEU",
            hint: "French midfielder who won the World Cup and Champions League before joining Middlesbrough",
          },
          {
            name: "NOLBERTO SOLANO",
            hint: "Peruvian midfielder who played for Newcastle United",
          },
          {
            name: "GAVIN MCCANN",
            hint: "English midfielder who played for Aston Villa and Bolton",
          },
          {
            name: "NICKLAS BENDTNER",
            hint: "Danish forward known for his time at Arsenal and his self-confidence",
          },
          {
            name: "ALVARO NEGREDO",
            hint: "Spanish striker who played for Manchester City and Middlesbrough",
          },
          {
            name: "ERIC NEVLAND",
            hint: "Norwegian forward who played for Fulham",
          },
          {
            name: "ANDY HINCHCLIFFE",
            hint: "English defender who played for Manchester City and Everton",
          },
          {
            name: "DARREN ANDERTON",
            hint: "English midfielder who played for Tottenham Hotspur and Portsmouth",
          },
          {
            name: "FRANK LEBOEUF",
            hint: "French defender who played for Chelsea and won the World Cup",
          },
          {
            name: "MIKE NEWELL",
            hint: "English striker who played for Blackburn Rovers and Everton",
          },
          {
            name: "JASON WILCOX",
            hint: "English winger who played for Blackburn Rovers. Won the Premier League in 1995",
          },
          {
            name: "PAUL RIDEOUT",
            hint: "English striker who scored the winning goal for Everton in the 1995 FA Cup Final",
          },
          {
            name: "BENITO CARBONE",
            hint: "Italian forward who played for Sheffield Wednesday and Bradford City",
          },
          {
            name: "DAVID UNSWORTH",
            hint: "English defender who played for Everton. Scored a lot of penalties",
          },
          {
            name: "MICHAEL DUBERRY",
            hint: "English defender who played for Chelsea and Leeds United",
          },
          {
            name: "DOMINIC MATTEO",
            hint: "Scottish defender who played for Liverpool and Leeds United",
          },
          {
            name: "STEVE HARKNESS",
            hint: "English defender who played for Liverpool",
          },
          {
            name: "WARREN BARTON",
            hint: "English defender who played for Newcastle United",
          },
          {
            name: "JIM MAGILTON",
            hint: "Northern Irish midfielder who played for Southampton and Ipswich Town",
          },
          {
            name: "ROD WALLACE",
            hint: "Scottish forward who played for Leeds United and Rangers",
          },
          {
            name: "SLAVEN BILIC",
            hint: "Croatian defender who played for West Ham United and Everton",
          },
          {
            name: "CARLO CUDICINI",
            hint: "Italian goalkeeper who played for Chelsea and Tottenham Hotspur",
          },
          {
            name: "QUINTON FORTUNE",
            hint: "South African midfielder who played for Manchester United",
          },
          {
            name: "MARK BOSNICH",
            hint: "Australian goalkeeper who played for Aston Villa and Manchester United",
          },
          {
            name: "PAPISS CISSE",
            hint: "Senegalese striker who scored some spectacular goals for Newcastle United",
          },
          {
            name: "JOHN OSTER",
            hint: "Welsh winger who played for Everton and Reading",
          },
          {
            name: "WILFRIED BONY",
            hint: "Ivorian striker who played for Swansea City and Manchester City",
          },
          {
            name: "TOMAS ROSICKY",
            hint: "Czech midfielder who played for Arsenal and Borussia Dortmund",
          },
          {
            name: "MORITZ VOLZ",
            hint: "German defender who played for Fulham and Ipswich Town",
          },
          {
            name: "PAUL KONCHESKY",
            hint: "English left-back who played for several Premier League clubs",
          },
          {
            name: "JAMES BEATTIE",
            hint: "English striker who played for Southampton and Everton",
          },
          {
            name: "PIERRE VAN HOOIJDONK",
            hint: "Dutch striker who played for Nottingham Forest and Celtic",
          },
          {
            name: "SEBASTIEN BASSONG",
            hint: "Cameroonian defender who played for Newcastle and Tottenham",
          },
          {
            name: "STEVEN PIENAAR",
            hint: "South African midfielder who played for Everton and Tottenham",
          },
          {
            name: "NIKO KRANJCAR",
            hint: "Croatian midfielder who played for Portsmouth and Tottenham",
          },
          {
            name: "IVAN CAMPO",
            hint: "Spanish midfielder who played for Bolton Wanderers and Real Madrid",
          },
          {
            name: "JOHN CAREW",
            hint: "Norwegian striker who played for Aston Villa and West Ham",
          },
          {
            name: "MAURO ZARATE",
            hint: "Argentinian forward who played for Birmingham City and West Ham",
          },
          {
            name: "LUKAS PODOLSKI",
            hint: "German forward who played for Arsenal. Owns a kebab shop",
          },
          {
            name: "THOMAS GRAVESEN",
            hint: "Danish midfielder who played for Everton and Real Madrid",
          },
          {
            name: "GARY BREEN",
            hint: "Irish defender who played for Coventry City and Sunderland",
          },
          {
            name: "NOEL WHELAN",
            hint: "English forward who played for Coventry City and Middlesbrough",
          },
          {
            name: "THOMAS BROLIN",
            hint: "Swedish forward who played for Leeds United",
          },
          {
            name: "HENRI CAMARA",
            hint: "Senegalese forward who played for Wigan Athletic",
          },
          {
            name: "SHAUN GOATER",
            hint: "Bermudian forward who played for Manchester City",
          },
          {
            name: "GEORGI KINKLADZE",
            hint: "Georgian midfielder known for his time at Manchester City",
          },
          {
            name: "GARETH FARRELLY",
            hint: "Irish midfielder who played for Everton and Bolton",
          },
          {
            name: "PETER NDLOVU",
            hint: "Zimbabwean forward who played for Coventry City",
          },
          {
            name: "MATTHEW UPSON",
            hint: "English defender known for his time at Birmingham City",
          },
          {
            name: "MARCO BOOGERS",
            hint: "Dutch striker who once hid in a caravan after being sent off",
          },
          {
            name: "PAPA BOUBA DIOP",
            hint: "Senegalese midfielder who played for Fulham. Scored the first goal of the 2002 World Cup",
          },
          {
            name: "PASCAL CHIMBONDA",
            hint: "French defender who played for Tottenham Hotspur, Sunderland and Wigan Athletic",
          },
          {
            name: "SERHIY REBROV",
            hint: "Ukrainian striker who flopped at Tottenham despite a prolific partnership with Andriy Shevchenko at Dynamo Kyiv",
          },
          {
            name: "KLEBERSON",
            hint: "Brazilian midfielder who won the World Cup in 2002 before joining Manchester United",
          },
          {
            name: "FABIO ROCHEMBACK",
            hint: "Brazilian midfielder who played for Barcelona, Sporting Lisbon and Middlesbrough",
          },
          {
            name: "DAVID BELLION",
            hint: "French striker who had an underwhelming spell at Manchester United in the early 2000s",
          },
          {
            name: "IGOR STEPANOVS",
            hint: "Latvian defender who Arsenal signed as cover but looked out of his depth in the Premier League",
          },
          {
            name: "PHILLIPE SENDEROS",
            hint: "Swiss defender who struggled at Arsenal before spells with Fulham and Aston Villa",
          },
          {
            name: "PER KROLDRUP",
            hint: "Danish defender who Everton signed for £5m in 2005 but made just one appearance before being sold",
          },
          {
            name: "BOSKO BALABAN",
            hint: "Croatian striker who Aston Villa signed for £5.8m in 2001 but made just nine appearances",
          },
          {
            name: "CHRIS BART-WILLIAMS",
            hint: "Midfielder who was a regular for Nottingham Forest in the 1990s but struggled after a big-money move to Sheffield Wednesday",
          },
          {
            name: "DARIUS VASSELL",
            hint: "English striker who scored on his England debut. Played for Aston Villa and Manchester City",
          },
          {
            name: "STEPHEN IRELAND",
            hint: "Irish midfielder who was named Manchester City's Player of the Year in 2009",
          },
          {
            name: "KAREL POBORSKY",
            hint: "Czech winger who scored a memorable chip at Euro 96 before joining Manchester United",
          },
          {
            name: "BRUNO CHEYROU",
            hint: "French midfielder who Gerard Houllier claimed would be the 'new Zidane' when he joined Liverpool",
          },
          {
            name: "ZOLTAN GERA",
            hint: "Hungarian midfielder who played for West Bromwich Albion and Fulham",
          },
          {
            name: "CHRISTOPHE DUGARRY",
            hint: "French forward who won the World Cup in 1998 before joining Birmingham City",
          },
          {
            name: "SALIF DIAO",
            hint: "Senegalese midfielder who joined Liverpool after impressing at the 2002 World Cup but struggled in the Premier League",
          },
          {
            name: "SEAN DUNDEE",
            hint: "South African striker who Liverpool signed for £2m in 1998 but made just five appearances",
          },
          {
            name: "JOZY ALTIDORE",
            hint: "American striker who scored just one Premier League goal during spells with Hull City and Sunderland",
          },
          {
            name: "ANDRE SANTOS",
            hint: "Brazilian left-back who Arsenal signed for £6.2m in 2011 but was defensively suspect and once swapped shirts with Robin van Persie at half-time",
          },
          {
            name: "TORBEN PIECHNIK",
            hint: "Danish defender who joined Liverpool in 1992 but made a series of high-profile errors",
          },
          {
            name: "JORDI CRUYFF",
            hint: "Son of legend who played for Manchester United and Barcelona",
          },
          {
            name: "KOSTAS MITROGLOU",
            hint: "Greek striker who Fulham signed for a club-record £12m in 2014 but scored just once",
          },
          {
            name: "CORRADO GRABBI",
            hint: "Italian striker who Blackburn Rovers signed for £6.75m in 2001 but failed to score a single goal",
          },
          {
            name: "MICHAEL RICKETTS",
            hint: "English striker who earned one England cap while at Bolton Wanderers but then faded into obscurity",
          },
          {
            name: "ADRIAN MUTU",
            hint: "Romanian striker who impressed at Chelsea before being sacked for failing a drugs test",
          },
          {
            name: "ADE AKINBIYI",
            hint: "Much-travelled Nigerian striker who had spells with Norwich City, Leicester City and Sheffield United",
          },
          {
            name: "ED DE GOEY",
            hint: "Dutch goalkeeper who played for Chelsea and Stoke City",
          },
          {
            name: "ERIC MEIJER",
            hint: "Dutch striker who had a brief spell with Liverpool in the late 1990s",
          },
          {
            name: "JEAN CLAUDE DARCHEVILLE",
            hint: "French striker who had brief spells with Nottingham Forest and Rennes in the late 1990s",
          },
          {
            name: "ERIK NEVLAND",
            hint: "Norwegian striker who had two spells with Manchester United in the late 1990s but made just one Premier League appearance",
          },
          {
            name: "NICLAS JENSEN",
            hint: "Danish defender who had brief spells with Manchester City and Borussia Dortmund in the late 1990s",
          },
          {
            name: "TITI CAMARA",
            hint: "Guinean striker who had a successful spell with Liverpool in 1999-2000, scoring 10 goals in 37 appearances",
          },
          {
            name: "TORRE ANDRE FLO",
            hint: "Norwegian striker who had a successful spell with Chelsea in the late 1990s and early 2000s",
          },
          {
            name: "HERMANN HREIDARSSON",
            hint: "Icelandic defender who had spells with Crystal Palace, Wimbledon Charlton Athletic and Portsmouth",
          },
          {
            name: "CARSTEN JANCKER",
            hint: "German striker who had a brief loan spell with Barnsley in 1998-99 but failed to score in six appearances",
          },
          {
            name: "DAVID BURROWS",
            hint: "English defender who played for West Bromwich Albion, Liverpool and Coventry City in the 1980s and 1990s",
          },
          {
            name: "OUMAR NIASSE",
            hint: "Senegalese striker who had underwhelming spells with Everton and Hull City in the mid-2010s",
          },
          {
            name: "ABEL XAVIER",
            hint: "Portuguese defender who had spells with Liverpool, Everton and Middlesbrough in the late 1990s and early 2000s",
          },
          {
            name: "IGOR BISCAN",
            hint: "Croatian midfielder who had a spell with Liverpool in the early 2000s",
          },
          {
            name: "LOMANA LUA LUA",
            hint: "Congolese winger who played for Newcastle United and Portsmouth in the mid-2000s",
          },
          {
            name: "MIDO",
            hint: "Egyptian striker who had spells with Tottenham Hotspur, Middlesbrough and Wigan Athletic in the mid-2000s",
          },
          {
            name: "MILAN BAROS",
            hint: "Czech striker who had spells with Liverpool, Aston Villa and Portsmouth in the mid-2000s",
          },
          {
            name: "MILAN JOVANOVIC",
            hint: "Serbian winger who had a brief spell with Liverpool in 2010-11 but made just 10 appearances",
          },
          {
            name: "JIRI JAROSIK",
            hint: "Czech midfielder who had a brief spell with Chelsea in 2005-06, scoring two goals in 17 appearances",
          },
          {
            name: "JERMAINE PENNANT",
            hint: "English winger who had spells with Arsenal, Birmingham City, Liverpool and Stoke City in the mid-2000s",
          },
          {
            name: "ELANO",
            hint: "Brazilian midfielder who had a brief spell with Manchester City in 2007-08, scoring six goals in 27 appearances",
          },
          {
            name: "FREDI KANOUTE",
            hint: "Malian striker who had a successful spell with Tottenham Hotspur in the mid-2000s",
          },
          {
            name: "DANIEL AMOKACHI",
            hint: "Nigerian striker who played for Everton in the mid-1990s",
          },
          {
            name: "DAN PETRESCU",
            hint: "Romanian defender who had spells with Sheffield Wednesday, Chelsea and Bradford City in the 1990s",
          },
        ],
      };

      // DOM elements
      const letterGrid = document.getElementById("letter-grid");
      const playerNameEl = document.getElementById("player-name");
      const timerEl = document.getElementById("timer");
      const timerBar = document.getElementById("timer-bar");
      const scoreEl = document.getElementById("score");
      const substitutionsEl = document.getElementById("substitutions");
      const passesEl = document.getElementById("passes");
      const varHintsEl = document.getElementById("var-hints");
      const guessesEl = document.getElementById("guesses");
      const roundInfoEl = document.getElementById("round-info");
      const currentTeamEl = document.getElementById("current-team");
      const startingLineupEl = document.getElementById("starting-lineup");

      let varHintTimeout;
      let substituteTimeout;

      // High Scores functions
      const MAX_HIGH_SCORES = 6;

      function getHighScores() {
        try {
          const highScores =
            JSON.parse(localStorage.getItem("highScores")) || [];
          return highScores
            .sort((a, b) => b.score - a.score)
            .slice(0, MAX_HIGH_SCORES);
        } catch (error) {
          logError(error, "getHighScores");
          return [];
        }
      }

      function saveHighScore(score) {
        try {
          const userName = localStorage.getItem("userName");
          const highScores = getHighScores();
          highScores.push({ name: userName, score: score });
          highScores.sort((a, b) => b.score - a.score);
          highScores.splice(MAX_HIGH_SCORES);
          localStorage.setItem("highScores", JSON.stringify(highScores));
        } catch (error) {
          logError(error, "saveHighScore");
          showMessage("Unable to save your score. Please try again later.");
        }
      }

      function updateHighScoresTable() {
        try {
          const highScores = getHighScores();
          const tableBody = document.getElementById("highScoresTableBody");
          tableBody.innerHTML = "";

          highScores.forEach((entry, index) => {
            const row = tableBody.insertRow();
            const positionCell = row.insertCell(0);
            const nameCell = row.insertCell(1);
            const pointsCell = row.insertCell(2);

            positionCell.textContent = index + 1;
            nameCell.textContent = entry.name;
            pointsCell.textContent = entry.score;

            positionCell.className = "text-white";
            nameCell.className = "text-white";
            pointsCell.className = "text-white";
          });
        } catch (error) {
          logError(error, "updateHighScoresTable");
          showMessage("Unable to update the high scores table.");
        }
      }

      function showHighScores() {
        try {
          const highScores = getHighScores();

          if (highScores.length === 0) {
            showMessage(
              "The season hasn't started yet. Please play your first game."
            );
          } else {
            updateHighScoresTable();
            openModal("highScoresModal");

            // Only show the "New Game" button if the game is over
            if (gameState.isGameOver) {
              document.getElementById("new-game").classList.remove("hidden");
            } else {
              document.getElementById("new-game").classList.add("hidden");
            }
          }
        } catch (error) {
          logError(error, "showHighScores");
          showMessage("Unable to display high scores. Please try again later.");
        }
      }

      function clearHighScores() {
        try {
          localStorage.removeItem("highScores");
          updateHighScoresTable();
          showMessage("High scores cleared!");
        } catch (error) {
          logError(error, "clearHighScores");
          showMessage("Unable to clear high scores. Please try again later.");
        }
      }

      // Game cycle management functions
      function getGameCount() {
        return parseInt(localStorage.getItem("gameCount") || "0");
      }

      function incrementGameCount() {
        const currentCount = getGameCount();
        localStorage.setItem("gameCount", (currentCount + 1).toString());
      }

      function resetGameCount() {
        localStorage.setItem("gameCount", "0");
      }

      function getRecentlyUsedPlayers() {
        try {
          return (
            JSON.parse(localStorage.getItem("recentlyUsedPlayers")) || {
              round1: [],
              round2: [],
              round3: [],
            }
          );
        } catch (error) {
          logError(error, "getRecentlyUsedPlayers");
          return {
            round1: [],
            round2: [],
            round3: [],
          };
        }
      }

      function saveRecentlyUsedPlayers(players) {
        try {
          localStorage.setItem("recentlyUsedPlayers", JSON.stringify(players));
        } catch (error) {
          logError(error, "saveRecentlyUsedPlayers");
        }
      }

      // Game functions
      function startGame() {
        try {
          const userName = localStorage.getItem("userName");

          if (!userName) {
            openModal("nameModal");
            return;
          }

          // Check if we need to reset the game count and clear recently used players
          const gameCount = getGameCount();
          if (gameCount >= 6) {
            resetGameCount();
            saveRecentlyUsedPlayers({ round1: [], round2: [], round3: [] });
          }

          gameState.reset();
          updateScore();
          updateSubstitutions();
          updatePassDisplay();
          updateVARHints();
          updateGuesses();
          resetTimerDisplay();
          updateRoundInfo();
          playerNameEl.textContent = "";
          currentTeamEl.classList.add("hidden");
          startingLineupEl.classList.add("hidden");
          document.getElementById("player-card").classList.add("hidden");
          document.getElementById("game-info-section").classList.add("hidden");
          toggleGameControls(false);
          document.getElementById("start-game").classList.add("hidden");
          document.getElementById("new-game").classList.add("hidden");

          letterGrid.innerHTML = "";
          letterGrid.classList.remove("hidden");

          const vowelContainer = document.createElement("div");
          vowelContainer.id = "vowel-container";
          vowelContainer.classList.add("mb-4", "p-2", "rounded-lg");
          vowelContainer.innerHTML =
            "<p class='text-center mb-2 text-white font-bold'>Select 1 vowel</p><div class='grid grid-cols-5 gap-2'></div>";

          const consonantContainer = document.createElement("div");
          consonantContainer.id = "consonant-container";
          consonantContainer.innerHTML =
            "<p class='text-center mb-2 text-white font-bold'>Select 4 consonants</p><div class='grid grid-cols-4 gap-2'></div>";

          letterGrid.appendChild(vowelContainer);
          letterGrid.appendChild(consonantContainer);

          selectInitialLetters();
        } catch (error) {
          logError(error, "startGame");
          showMessage(
            "An error occurred while starting the game. Please refresh the page and try again."
          );
        }
      }

      function selectInitialLetters() {
        try {
          const vowelGrid = document.querySelector("#vowel-container .grid");
          const consonantGrid = document.querySelector(
            "#consonant-container .grid"
          );
          vowelGrid.innerHTML = "";
          consonantGrid.innerHTML = "";

          gameState.availableLetters.forEach((letter) => {
            const button = document.createElement("button");
            button.textContent = letter;
            button.classList.add(
              "letter-btn",
              "bg-blue-600",
              "hover:bg-blue-500",
              "text-white",
              "font-bold",
              "py-2",
              "px-4",
              "rounded-lg",
              "transition",
              "duration-300",
              "text-lg",
              "sm:text-xl"
            );
            button.addEventListener("click", () =>
              toggleLetter(letter, button)
            );

            if (VOWELS.includes(letter)) {
              vowelGrid.appendChild(button);
            } else {
              consonantGrid.appendChild(button);
            }
          });

          updateStartingLineup();
        } catch (error) {
          logError(error, "selectInitialLetters");
          showMessage(
            "An error occurred while setting up the letter selection. Please refresh the page and try again."
          );
        }
      }

      function toggleLetter(letter, button) {
        try {
          const index = gameState.chosenLetters.indexOf(letter);
          const isVowel = VOWELS.includes(letter);

          if (index === -1 && gameState.chosenLetters.length < 5) {
            if (isVowel && gameState.vowelCount >= 1) {
              showMessage("You can only select one vowel!");
              return;
            }
            if (
              !isVowel &&
              gameState.chosenLetters.length - gameState.vowelCount >= 4
            ) {
              showMessage("You can only select four consonants!");
              return;
            }
            gameState.chosenLetters.push(letter);
            button.classList.remove("bg-blue-600", "hover:bg-blue-500");
            button.classList.add("bg-green-700", "hover:bg-green-800");
            if (isVowel) gameState.vowelCount++;
          } else if (index !== -1) {
            gameState.chosenLetters.splice(index, 1);
            button.classList.remove("bg-green-700", "hover:bg-green-800");
            button.classList.add("bg-blue-600", "hover:bg-blue-500");
            if (isVowel) gameState.vowelCount--;
          }
          updateStartingLineup();
          if (gameState.chosenLetters.length === 5) {
            document.getElementById("start-game").classList.remove("hidden");
            scrollToStartGameButton();
          } else {
            document.getElementById("start-game").classList.add("hidden");
          }
        } catch (error) {
          logError(error, "toggleLetter");
          showMessage(
            "An error occurred while selecting letters. Please try again."
          );
        }
      }

      function scrollToStartGameButton() {
        try {
          const startGameButton = document.getElementById("start-game");
          startGameButton.scrollIntoView({
            behavior: "smooth",
            block: "center",
          });
        } catch (error) {
          logError(error, "scrollToStartGameButton");
          showMessage(
            "An error occurred while scrolling to the start game button. Please try again."
          );
        }
      }

      function updateStartingLineup() {
        try {
          startingLineupEl.textContent = `Your starting lineup: ${gameState.chosenLetters.join(
            ", "
          )}`;
          startingLineupEl.classList.remove("hidden");
        } catch (error) {
          logError(error, "updateStartingLineup");
          showMessage(
            "An error occurred while updating the starting lineup. Please refresh the page."
          );
        }
      }

      function updateCurrentTeam() {
        try {
          currentTeamEl.textContent = `Your current team: ${gameState.chosenLetters.join(
            ", "
          )}`;
        } catch (error) {
          logError(error, "updateCurrentTeam");
          showMessage(
            "An error occurred while updating the current team. Please refresh the page."
          );
        }
      }

      function startRound() {
        try {
          if (gameState.wrongGuesses >= 3) {
            endGame();
            return;
          }

          gameState.currentRound++;
          gameState.timeLeft = gameState.currentRound === 3 ? 30 : 45;
          gameState.usedPlayers[gameState.currentRound] = []; // Reset used players for this round

          gameState.allChosenLetters.clear();
          gameState.chosenLetters.forEach((letter) =>
            gameState.allChosenLetters.add(letter.toUpperCase())
          );

          selectRandomPlayer();
          updateDisplayedName();
          startTimer();
          updateRoundInfo();
          letterGrid.classList.add("hidden");
          startingLineupEl.classList.add("hidden");
          currentTeamEl.classList.remove("hidden");
          document.getElementById("player-card").classList.remove("hidden");
          document
            .getElementById("game-info-section")
            .classList.remove("hidden");
          document.getElementById("start-game").classList.add("hidden");
          toggleGameControls(true);
          updateCurrentTeam();
          showGameInfoSection();
          updateDisplay();
        } catch (error) {
          logError(error, "startRound");
          showMessage(
            "An error occurred while starting the round. Please refresh the page and try again."
          );
        }
      }

      function updateRoundInfo() {
        try {
          if (gameState.currentRound === 0) {
            roundInfoEl.textContent =
              "Choose 5 letters for your starting lineup!";
          } else {
            let roundMessage;
            switch (gameState.currentRound) {
              case 1:
                roundMessage = "Guess the current Premier League player!";
                break;
              case 2:
                roundMessage = "Guess the Premier League legend!";
                break;
              case 3:
                roundMessage = "Guess the forgotten Premier League star!";
                break;
            }
            roundInfoEl.textContent = `Round ${gameState.currentRound}: ${roundMessage}`;
          }
        } catch (error) {
          logError(error, "updateRoundInfo");
          showMessage(
            "An error occurred while updating round information. Please refresh the page."
          );
        }
      }

      function updateDisplayedName() {
        try {
          const newDisplayedName = gameState.currentPlayer.name
            .split("")
            .map((char) =>
              char === " "
                ? " "
                : gameState.allChosenLetters.has(char.toUpperCase())
                ? `<span class="letter-reveal">${char}</span>`
                : "_"
            )
            .join("");

          if (playerNameEl.innerHTML !== newDisplayedName) {
            playerNameEl.innerHTML = newDisplayedName;
            playerNameEl
              .querySelectorAll(".letter-reveal")
              .forEach((span, index) => {
                span.style.transitionDelay = `${index * 100}ms`;
                setTimeout(() => (span.style.color = "white"), 50);
              });
          }
        } catch (error) {
          logError(error, "updateDisplayedName");
          showMessage(
            "An error occurred while updating the displayed name. Please refresh the page."
          );
        }
      }

      function startTimer() {
        try {
          clearInterval(gameState.timerInterval);
          gameState.timerInterval = setInterval(() => {
            gameState.timeLeft--;
            updateTimerDisplay();
            if (gameState.timeLeft <= 0) {
              clearInterval(gameState.timerInterval);
              if (gameState.currentRound < 3) {
                startRound();
              } else {
                endGame();
              }
            }
          }, 1000);
        } catch (error) {
          logError(error, "startTimer");
          showMessage(
            "An error occurred with the game timer. Please refresh the page and try again."
          );
        }
      }

      function updateTimerDisplay() {
        try {
          timerEl.textContent = `Time: ${gameState.timeLeft}s`;
          const totalTime = gameState.currentRound === 3 ? 30 : 45;
          const percentage = (gameState.timeLeft / totalTime) * 100;
          timerBar.style.width = `${percentage}%`;
          if (gameState.timeLeft <= 10) {
            timerBar.classList.add("pulse");
          } else {
            timerBar.classList.remove("pulse");
          }
        } catch (error) {
          logError(error, "updateTimerDisplay");
          // We don't show a message here to avoid disrupting gameplay
        }
      }

      function substituteLetters() {
        try {
          if (gameState.substitutionsLeft > 0) {
            openModal("substituteModal");
            substituteTimeout = setTimeout(() => {
              gameState.substitutionTimeoutCount++;
              showMessage(
                "Hey that is enough of that time-wasting! Get on with the game!"
              );
              if (gameState.substitutionTimeoutCount >= 2) {
                gameState.substitutionsLeft = 0;
                updateSubstitutions();
                showMessage("All remaining substitutions lost!");
              }
              closeModal("substituteModal");
            }, 20000);
          } else {
            showMessage("No substitutions left!");
          }
        } catch (error) {
          logError(error, "substituteLetters");
          showMessage(
            "An error occurred while substituting letters. Please try again."
          );
        }
      }

      function showSubstituteOptions() {
        try {
          const substituteGrid = document.getElementById("substitute-grid");
          substituteGrid.innerHTML = `
      <div class="mb-4">
        <h3 class="text-lg font-bold mb-2 text-white">Select letters to substitute</h3>
        <div id="current-letters-grid" class="grid grid-cols-5 gap-2 mb-4"></div>
        <div id="available-letters-grid" class="grid grid-cols-5 gap-2"></div>
      </div>
      <button id="confirm-substitution" class="w-full bg-yellow-600 hover:bg-yellow-700 text-white font-bold py-2 px-4 rounded transition duration-300">
        Make substitutions
      </button>
      `;

          const currentLettersGrid = document.getElementById(
            "current-letters-grid"
          );
          const availableLettersGrid = document.getElementById(
            "available-letters-grid"
          );

          gameState.chosenLetters.forEach((letter, index) => {
            const button = createLetterButton(letter, "current", index);
            currentLettersGrid.appendChild(button);
          });

          gameState.availableLetters.forEach((letter) => {
            if (
              !gameState.chosenLetters.includes(letter) &&
              !gameState.usedLetters.has(letter)
            ) {
              const button = createLetterButton(letter, "available");
              availableLettersGrid.appendChild(button);
            }
          });

          document
            .getElementById("confirm-substitution")
            .addEventListener("click", confirmSubstitution);
          updateAvailableLetters();

          // Reset pending substitutions when opening the modal
          gameState.pendingSubstitutions = {};
        } catch (error) {
          logError(error, "showSubstituteOptions");
          showMessage(
            "An error occurred while showing substitution options. Please try again."
          );
        }
      }

      function createLetterButton(letter, type, index) {
        try {
          const button = document.createElement("button");
          button.textContent = letter;
          button.classList.add(
            "letter-btn",
            "text-white",
            "font-bold",
            "rounded-lg",
            "text-xl",
            "transition",
            "duration-300",
            "w-full",
            "h-12",
            "flex",
            "items-center",
            "justify-center"
          );

          if (type === "current") {
            const color =
              SUBSTITUTION_COLORS[index % SUBSTITUTION_COLORS.length];
            gameState.substitutionColorMap[letter] = color;
            button.classList.add(color, `hover:${color.replace("600", "700")}`);
            button.addEventListener("click", () =>
              toggleCurrentLetter(letter, button)
            );
          } else {
            button.classList.add(
              "bg-gray-600",
              "opacity-50",
              "cursor-not-allowed"
            );
            button.addEventListener("click", () =>
              toggleAvailableLetter(letter, button)
            );
          }

          return button;
        } catch (error) {
          logError(error, "createLetterButton");
          showMessage(
            "An error occurred while creating letter buttons. Please refresh the page."
          );
          return document.createElement("button");
        }
      }

      function toggleCurrentLetter(letter, button) {
        try {
          if (gameState.pendingSubstitutions[letter]) {
            const color = gameState.substitutionColorMap[letter];
            delete gameState.pendingSubstitutions[letter];
            button.classList.remove(
              color,
              `hover:${color.replace("600", "700")}`
            );
            button.classList.add(color, "hover:bg-blue-500");
          } else {
            const color = gameState.substitutionColorMap[letter];
            gameState.pendingSubstitutions[letter] = null;
            button.classList.remove("bg-blue-600", "hover:bg-blue-700");
            button.classList.add(color, `hover:${color.replace("600", "700")}`);
          }
          updateAvailableLetters();
        } catch (error) {
          logError(error, "toggleCurrentLetter");
          showMessage(
            "An error occurred while selecting a letter. Please try again."
          );
        }
      }

      function toggleAvailableLetter(letter, button) {
        try {
          const isVowel = VOWELS.includes(letter);
          const correspondingCurrentLetter = Object.keys(
            gameState.pendingSubstitutions
          ).find(
            (key) =>
              gameState.pendingSubstitutions[key] === null &&
              VOWELS.includes(key) === isVowel
          );

          if (correspondingCurrentLetter) {
            const color =
              gameState.substitutionColorMap[correspondingCurrentLetter];
            if (
              gameState.pendingSubstitutions[correspondingCurrentLetter] ===
              letter
            ) {
              gameState.pendingSubstitutions[correspondingCurrentLetter] = null;
              button.classList.remove(
                color,
                `hover:${color.replace("600", "700")}`
              );
              button.classList.add(
                "bg-gray-600",
                "opacity-50",
                "cursor-not-allowed"
              );
            } else {
              gameState.pendingSubstitutions[correspondingCurrentLetter] =
                letter;
              button.classList.remove(
                "bg-gray-600",
                "opacity-50",
                "cursor-not-allowed"
              );
              button.classList.add(
                color,
                `hover:${color.replace("600", "700")}`
              );
            }
          }
          updateAvailableLetters();
        } catch (error) {
          logError(error, "toggleAvailableLetter");
          showMessage(
            "An error occurred while selecting a letter. Please try again."
          );
        }
      }

      function updateAvailableLetters() {
        try {
          const availableButtons = document.querySelectorAll(
            "#available-letters-grid .letter-btn"
          );
          const pendingVowels = Object.keys(
            gameState.pendingSubstitutions
          ).filter(
            (letter) =>
              VOWELS.includes(letter) &&
              gameState.pendingSubstitutions[letter] === null
          ).length;
          const pendingConsonants = Object.keys(
            gameState.pendingSubstitutions
          ).filter(
            (letter) =>
              !VOWELS.includes(letter) &&
              gameState.pendingSubstitutions[letter] === null
          ).length;

          availableButtons.forEach((btn) => {
            const letter = btn.textContent;
            const isSelected = Object.values(
              gameState.pendingSubstitutions
            ).includes(letter);
            const correspondingCurrentLetter = Object.keys(
              gameState.pendingSubstitutions
            ).find((key) => gameState.pendingSubstitutions[key] === letter);

            btn.classList.remove(
              ...SUBSTITUTION_COLORS,
              ...SUBSTITUTION_COLORS.map(
                (color) => `hover:${color.replace("600", "700")}`
              )
            );

            if (isSelected) {
              const color =
                gameState.substitutionColorMap[correspondingCurrentLetter];
              btn.classList.remove(
                "bg-gray-600",
                "opacity-50",
                "cursor-not-allowed"
              );
              btn.classList.add(color, `hover:${color.replace("600", "700")}`);
            } else if (
              (VOWELS.includes(letter) && pendingVowels > 0) ||
              (!VOWELS.includes(letter) && pendingConsonants > 0)
            ) {
              btn.classList.remove(
                "bg-gray-600",
                "opacity-50",
                "cursor-not-allowed"
              );
              btn.classList.add(
                "bg-green-600",
                "hover:bg-green-700",
                "cursor-pointer"
              );
            } else {
              btn.classList.remove(
                "bg-green-600",
                "hover:bg-green-700",
                "cursor-pointer"
              );
              btn.classList.add(
                "bg-gray-600",
                "opacity-50",
                "cursor-not-allowed"
              );
            }
          });
        } catch (error) {
          logError(error, "updateAvailableLetters");
          showMessage(
            "An error occurred while updating available letters. Please refresh the page."
          );
        }
      }

      function confirmSubstitution() {
        try {
          const substitutions = Object.entries(
            gameState.pendingSubstitutions
          ).filter(([_, newLetter]) => newLetter !== null);

          if (
            substitutions.length > 0 &&
            substitutions.length <= gameState.substitutionsLeft
          ) {
            substitutions.forEach(([oldLetter, newLetter]) => {
              const index = gameState.chosenLetters.indexOf(oldLetter);
              gameState.chosenLetters[index] = newLetter;
              gameState.usedLetters.add(oldLetter);
              gameState.usedLetters.add(newLetter);
              gameState.allChosenLetters.add(newLetter.toUpperCase());
            });

            gameState.substitutionsLeft -= substitutions.length;
            updateSubstitutions();
            updateCurrentTeam();
            updateDisplayedName();
            closeModal("substituteModal");
            resumeTimer();
            showSubstitutionFeedback(
              substitutions.map(([oldLetter]) => oldLetter),
              substitutions.map(([, newLetter]) => newLetter)
            );
          } else if (substitutions.length === 0) {
            showMessage("Please select new letters to substitute!");
          } else if (substitutions.length > gameState.substitutionsLeft) {
            showMessage(
              `You only have ${gameState.substitutionsLeft} substitution(s) left!`
            );
          } else {
            showMessage("An error occurred. Please try again.");
          }

          // Clear pending substitutions after processing
          gameState.pendingSubstitutions = {};
        } catch (error) {
          logError(error, "confirmSubstitution");
          showMessage(
            "An error occurred while confirming substitutions. Please try again."
          );
        }
      }

      function showSubstitutionFeedback(oldLetters, newLetters) {
        try {
          const feedbackEl = document.createElement("div");
          feedbackEl.classList.add(
            "text-center",
            "text-white",
            "my-4",
            "p-2",
            "bg-blue-600",
            "rounded"
          );
          feedbackEl.innerHTML = `Substituted: ${oldLetters.join(
            ", "
          )} ➡️ ${newLetters.join(", ")}`;
          document
            .getElementById("game-container")
            .insertBefore(feedbackEl, roundInfoEl);
          setTimeout(() => feedbackEl.remove(), 3000);
        } catch (error) {
          logError(error, "showSubstitutionFeedback");
          // Don't show a message here to avoid disrupting the game flow
        }
      }

      function passPlayer() {
        try {
          if (gameState.passesLeft > 0) {
            gameState.passesLeft--;
            showPassFeedback();
            moveToNextPlayer();
          } else {
            showMessage("No passes left!");
          }
        } catch (error) {
          logError(error, "passPlayer");
          showMessage("An error occurred while passing. Please try again.");
        }
      }

      function showPassFeedback() {
        try {
          const feedbackEl = document.createElement("div");
          feedbackEl.classList.add(
            "text-center",
            "text-white",
            "my-4",
            "p-2",
            "bg-yellow-600",
            "rounded",
            "animate-fade-in-out"
          );
          feedbackEl.textContent = "That's a sideways pass! Next player...";
          document
            .getElementById("game-container")
            .insertBefore(feedbackEl, roundInfoEl);
          setTimeout(() => feedbackEl.remove(), 2000);
        } catch (error) {
          logError(error, "showPassFeedback");
          // Don't show a message here to avoid disrupting the game flow
        }
      }

      function updatePassDisplay() {
        try {
          passesEl.textContent = `Passes: ${gameState.passesLeft}`;
          document.getElementById("pass").disabled = gameState.passesLeft <= 0;
        } catch (error) {
          logError(error, "updatePassDisplay");
          // Don't show a message here to avoid disrupting the game flow
        }
      }

      function showVARHint() {
        try {
          if (gameState.varHintsLeft > 0) {
            gameState.varHintsLeft--;
            openModal("varHintModal");
            document.getElementById("varHintText").textContent =
              gameState.currentPlayer.hint;
            updateVARHints();
            varHintTimeout = setTimeout(() => {
              closeModal("varHintModal");
            }, 20000); // Close after 20 seconds
          } else {
            showMessage("You can't go to VAR!");
          }
        } catch (error) {
          logError(error, "showVARHint");
          showMessage(
            "An error occurred while showing the VAR hint. Please try again."
          );
        }
      }

      function updateVARHints() {
        try {
          varHintsEl.textContent = `VAR: ${gameState.varHintsLeft}`;
          document.getElementById("var").disabled = gameState.varHintsLeft <= 0;
        } catch (error) {
          logError(error, "updateVARHints");
          // Don't show a message here to avoid disrupting the game flow
        }
      }

      let guessModalTimer;
      function openGuessModal() {
        try {
          openModal("guessModal");
          let timeLeft = 20;
          updateGuessModalTimer(timeLeft);
          guessModalTimer = setInterval(() => {
            timeLeft--;
            updateGuessModalTimer(timeLeft);
            if (timeLeft <= 0) {
              clearInterval(guessModalTimer);
              processGuess();
            }
          }, 1000);

          // Set focus on the input field
          document.getElementById("guess-input").focus();
        } catch (error) {
          logError(error, "openGuessModal");
          showMessage(
            "An error occurred while opening the guess modal. Please try again."
          );
        }
      }

      function updateGuessModalTimer(time) {
        try {
          document.getElementById(
            "guess-timer"
          ).textContent = `Time left: ${time}s`;
        } catch (error) {
          logError(error, "updateGuessModalTimer");
          // Don't show a message here to avoid disrupting the game flow
        }
      }

      function processGuess() {
        try {
          clearInterval(guessModalTimer);
          const guess = document
            .getElementById("guess-input")
            .value.toUpperCase()
            .trim();
          if (guess === gameState.currentPlayer.name) {
            gameState.score += gameState.currentRound === 3 ? 3 : 1;
            updateScore();
            showSuccessMessage("Correct! Well done!");
            closeModal("guessModal");
            moveToNextPlayer();
          } else {
            gameState.wrongGuesses++;
            updateGuesses();
            showIncorrectGuessPopup();
            if (gameState.wrongGuesses >= 3) {
              closeModal("guessModal");
              endGame();
              return;
            }
            moveToNextPlayer(); // Move to the next player on a wrong guess
          }
          document.getElementById("guess-input").value = "";
          closeModal("guessModal");
        } catch (error) {
          logError(error, "processGuess");
          showMessage(
            "An error occurred while processing your guess. Please try again."
          );
        }
      }

      function moveToNextPlayer() {
        try {
          selectRandomPlayer();
          updateDisplayedName();
          updateDisplay();
        } catch (error) {
          logError(error, "moveToNextPlayer");
          showMessage(
            "An error occurred while moving to the next player. Please refresh the page."
          );
        }
      }

      function showSuccessMessage(message) {
        try {
          const popup = document.getElementById("guess-popup");
          popup.textContent = message;
          popup.classList.remove("hidden", "bg-yellow-500");
          popup.classList.add("bg-green-500", "text-white");
          setTimeout(() => {
            popup.classList.add("hidden");
          }, 2000);
        } catch (error) {
          logError(error, "showSuccessMessage");
          // Don't show a message here to avoid disrupting the game flow
        }
      }

      function showIncorrectGuessPopup() {
        try {
          const popup = document.getElementById("guess-popup");
          let message;
          let color;
          switch (gameState.wrongGuesses) {
            case 1:
              message =
                "The ref wants the game to flow so that's just a warning";
              color = "bg-white text-black";
              break;
            case 2:
              message = "Oooooo, that's a booking!";
              color = "bg-yellow-500 text-black";
              break;
            case 3:
              message = "That's a shocking tackle! Get off the pitch!";
              color = "bg-red-600 text-white";
              break;
            default:
              message = "Incorrect guess!";
              color = "bg-white text-black";
          }
          popup.textContent = message;
          popup.className = `fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 p-3 rounded-lg shadow-lg text-center ${color}`;
          popup.classList.remove("hidden");
          setTimeout(() => {
            popup.classList.add("hidden");
          }, 2000);
        } catch (error) {
          logError(error, "showIncorrectGuessPopup");
          // Don't show a message here to avoid disrupting the game flow
        }
      }

      function endGame() {
        try {
          clearInterval(gameState.timerInterval);
          gameState.isGameOver = true;

          // Close all modals
          closeModal("guessModal");
          closeModal("varHintModal");
          closeModal("substituteModal");

          roundInfoEl.textContent = `The ref has blown the final whistle. You picked up: ${gameState.score} points`;
          timerEl.textContent = "Time:0s";
          timerBar.style.width = "0%";
          guessesEl.textContent = "Guesses: 0";
          passesEl.textContent = "Passes: 0";
          substitutionsEl.textContent = "Subs: 0";
          varHintsEl.textContent = "VAR: 0";
          scoreEl.textContent = `Points: ${gameState.score}`;
          toggleGameControls(false);
          playerNameEl.textContent = "";
          currentTeamEl.classList.add("hidden");

          // Reset timer and timer bar
          gameState.timeLeft = 0;
          updateTimerDisplay();

          // Update game count and recently used players
          const gameCount = getGameCount();
          incrementGameCount();

          const recentlyUsedPlayers = getRecentlyUsedPlayers();

          for (let round = 1; round <= 3; round++) {
            const roundKey = `round${round}`;
            const roundPlayers = gameState.usedPlayers[round];

            recentlyUsedPlayers[roundKey] = [
              ...new Set([...roundPlayers, ...recentlyUsedPlayers[roundKey]]),
            ].slice(0, 10);
          }

          if (gameCount >= 6) {
            // Reset after 6 games (0-9)
            resetGameCount();
            saveRecentlyUsedPlayers({ round1: [], round2: [], round3: [] });
          } else {
            saveRecentlyUsedPlayers(recentlyUsedPlayers);
          }

          // Save and show high scores
          saveHighScore(gameState.score);
          showHighScores();

          // Show the "New Game" button
          document.getElementById("new-game").classList.remove("hidden");
        } catch (error) {
          logError(error, "endGame");
          showMessage(
            "An error occurred while ending the game. Please refresh the page."
          );
        }
      }

      function updateScore() {
        try {
          scoreEl.textContent = `Points: ${gameState.score}`;
        } catch (error) {
          logError(error, "updateScore");
          // Don't show a message here to avoid disrupting the game flow
        }
      }

      function updateSubstitutions() {
        try {
          substitutionsEl.textContent = `Subs: ${gameState.substitutionsLeft}`;
          document.getElementById("substitute").disabled =
            gameState.substitutionsLeft <= 0;
        } catch (error) {
          logError(error, "updateSubstitutions");
          // Don't show a message here to avoid disrupting the game flow
        }
      }

      function updateGuesses() {
        try {
          guessesEl.textContent = `Guesses: ${3 - gameState.wrongGuesses}`;
        } catch (error) {
          logError(error, "updateGuesses");
          // Don't show a message here to avoid disrupting the game flow
        }
      }

      function toggleGameControls(show) {
        try {
          const gameControls = document.getElementById("game-controls");
          if (show) {
            gameControls.classList.remove("hidden");
            gameControls.classList.add("flex");
          } else {
            gameControls.classList.add("hidden");
            gameControls.classList.remove("flex");
          }
        } catch (error) {
          logError(error, "toggleGameControls");
          showMessage(
            "An error occurred while updating game controls. Please refresh the page."
          );
        }
      }

      function openModal(modalId) {
        try {
          const modal = document.getElementById(modalId);
          modal.classList.remove("hidden");
          modal.classList.add("flex");
          document
            .getElementById("game-container")
            .classList.add("blur-background");

          if (modalId === "guessModal") {
            document.getElementById("guess-input").value = "";
            document.getElementById("guess-timer").textContent =
              "Time left: 20s";
          } else if (modalId === "substituteModal") {
            showSubstituteOptions();
          } else if (modalId === "instructionsModal") {
            currentSlide = 0;
            showSlide(currentSlide);
          }

          // Only pause the timer if the game is in progress
          if (gameState.currentRound > 0 && !gameState.isGameOver) {
            pauseTimer();
          }
        } catch (error) {
          logError(error, "openModal");
          showMessage(
            "An error occurred while opening the modal. Please try again."
          );
        }
      }

      function closeModal(modalId) {
        try {
          if (modalId === "nameModal") {
            const nameInput = document.getElementById("nameInput").value.trim();
            if (nameInput === "") {
              showMessage("Please enter a valid name.");
              return;
            }
          }

          const modal = document.getElementById(modalId);
          modal.classList.add("hidden");
          modal.classList.remove("flex");
          document
            .getElementById("game-container")
            .classList.remove("blur-background");

          if (modalId === "guessModal") {
            clearInterval(guessModalTimer);
          } else if (modalId === "varHintModal") {
            clearTimeout(varHintTimeout);
          } else if (modalId === "substituteModal") {
            clearTimeout(substituteTimeout);
          }

          // Only resume the timer if the game is in progress
          if (gameState.currentRound > 0 && !gameState.isGameOver) {
            resumeTimer();
          }
        } catch (error) {
          logError(error, "closeModal");
          showMessage(
            "An error occurred while closing the modal. Please try again."
          );
        }
      }

      function pauseTimer() {
        try {
          clearInterval(gameState.timerInterval);
        } catch (error) {
          logError(error, "pauseTimer");
          // Don't show a message here to avoid disrupting the game flow
        }
      }

      function resumeTimer() {
        try {
          startTimer();
        } catch (error) {
          logError(error, "resumeTimer");
          showMessage(
            "An error occurred while resuming the timer. Please refresh the page."
          );
        }
      }

      function resetTimerDisplay() {
        try {
          timerEl.textContent = `Time: ${gameState.timeLeft}s`;
          timerBar.style.width = "100%";
          timerBar.classList.remove("pulse");
        } catch (error) {
          logError(error, "resetTimerDisplay");
          // Don't show a message here to avoid disrupting the game flow
        }
      }

      function showGameInfoSection() {
        try {
          document
            .getElementById("game-info-section")
            .classList.remove("hidden");
        } catch (error) {
          logError(error, "showGameInfoSection");
          showMessage(
            "An error occurred while showing game information. Please refresh the page."
          );
        }
      }

      function showMessage(message) {
        try {
          const messageEl = document.createElement("div");
          messageEl.classList.add(
            "fixed",
            "top-1/2",
            "left-1/2",
            "transform",
            "-translate-x-1/2",
            "-translate-y-1/2",
            "bg-green-600",
            "text-white",
            "p-4",
            "rounded",
            "text-center",
            "shadow-lg",
            "z-50"
          );
          messageEl.textContent = message;
          document.body.appendChild(messageEl);
          setTimeout(() => messageEl.remove(), 2000);
        } catch (error) {
          logError(error, "showMessage");
          console.error("Failed to show message:", message);
        }
      }

      function selectRandomPlayer() {
        try {
          const availablePlayers =
            gameState.currentRound === 1
              ? playerList.modernPlayers
              : gameState.currentRound === 2
              ? playerList.legendPlayers
              : playerList.obscurePlayers;

          const recentlyUsedPlayers = getRecentlyUsedPlayers();
          const currentRoundUsedPlayers =
            recentlyUsedPlayers[`round${gameState.currentRound}`];

          // Filter out recently used players for the current round
          let unusedPlayers = availablePlayers.filter(
            (player) =>
              !gameState.usedPlayers[gameState.currentRound].includes(
                player.name
              ) && !currentRoundUsedPlayers.includes(player.name)
          );

          // If all players have been used in this game or recently, reset the used players for this round
          if (unusedPlayers.length === 0) {
            unusedPlayers = availablePlayers.filter(
              (player) => !currentRoundUsedPlayers.includes(player.name)
            );
            gameState.usedPlayers[gameState.currentRound] = [];
          }

          // If all players have been used recently, use all available players
          if (unusedPlayers.length === 0) {
            unusedPlayers = availablePlayers;
          }

          gameState.currentPlayer =
            unusedPlayers[Math.floor(Math.random() * unusedPlayers.length)];
          gameState.usedPlayers[gameState.currentRound].push(
            gameState.currentPlayer.name
          );
        } catch (error) {
          logError(error, "selectRandomPlayer");
          showMessage(
            "An error occurred while selecting a player. Please refresh the page."
          );
          // Fallback: select a random player from all available players
          const allPlayers = [
            ...playerList.modernPlayers,
            ...playerList.legendPlayers,
            ...playerList.obscurePlayers,
          ];
          gameState.currentPlayer =
            allPlayers[Math.floor(Math.random() * allPlayers.length)];
        }
      }

      function updateDisplay() {
        try {
          updateScore();
          updateSubstitutions();
          updatePassDisplay();
          updateVARHints();
          updateTimerDisplay();
          updateRoundInfo();
        } catch (error) {
          logError(error, "updateDisplay");
          showMessage(
            "An error occurred while updating the display. Please refresh the page."
          );
        }
      }

      // Event listeners
      document
        .getElementById("start-game")
        .addEventListener("click", startRound);
      document.getElementById("new-game").addEventListener("click", startGame);
      document
        .getElementById("guess")
        .addEventListener("click", openGuessModal);
      document.getElementById("pass").addEventListener("click", passPlayer);
      document
        .getElementById("substitute")
        .addEventListener("click", substituteLetters);
      document.getElementById("var").addEventListener("click", showVARHint);
      document
        .getElementById("submit-guess")
        .addEventListener("click", processGuess);
      document
        .getElementById("close-var-hint")
        .addEventListener("click", () => closeModal("varHintModal"));
      document
        .getElementById("close-high-scores")
        .addEventListener("click", () => closeModal("highScoresModal"));
      document
        .getElementById("view-high-scores-btn")
        .addEventListener("click", showHighScores);
      document
        .getElementById("view-high-scores-btn-mobile")
        .addEventListener("click", showHighScores);
      document
        .getElementById("clear-high-scores")
        .addEventListener("click", clearHighScores);

      document.querySelectorAll(".fixed.inset-0").forEach((modal) => {
        modal.addEventListener("click", function (event) {
          if (event.target === this) {
            closeModal(this.id);
          }
        });
      });

      document
        .getElementById("guess-input")
        .addEventListener("keypress", function (e) {
          if (e.key === "Enter") {
            e.preventDefault();
            processGuess();
          }
        });

      // How to Play Modal
      const howToPlayBtn = document.getElementById("how-to-play-btn-desktop");
      const howToPlayBtnMobile = document.getElementById(
        "how-to-play-btn-mobile"
      );
      const instructionsModal = document.getElementById("instructionsModal");
      const carouselItems = document.querySelectorAll(".carousel-item");
      let currentSlide = 0;

      function showSlide(index) {
        try {
          carouselItems.forEach((item, i) => {
            if (i === index) {
              item.classList.add("active");
              item.classList.remove("hidden");
            } else {
              item.classList.remove("active");
              item.classList.add("hidden");
            }
          });
        } catch (error) {
          logError(error, "showSlide");
          showMessage(
            "An error occurred while showing the slide. Please try again."
          );
        }
      }

      function saveName() {
        try {
          const nameInput = document.getElementById("nameInput");
          const name = nameInput.value.trim();

          if (name !== "") {
            localStorage.setItem("userName", name);
            closeModal("nameModal");
            startGame();
          } else {
            showMessage("Please enter a valid name.");
          }
        } catch (error) {
          logError(error, "saveName");
          showMessage("Unable to save your name. Please try again.");
        }
      }

      document
        .getElementById("saveNameBtn")
        .addEventListener("click", saveName);

      document.getElementById("next-btn").addEventListener("click", () => {
        try {
          currentSlide = (currentSlide + 1) % carouselItems.length;
          showSlide(currentSlide);
        } catch (error) {
          logError(error, "nextSlide");
          showMessage(
            "An error occurred while navigating to the next slide. Please try again."
          );
        }
      });

      document.getElementById("prev-btn").addEventListener("click", () => {
        try {
          currentSlide =
            (currentSlide - 1 + carouselItems.length) % carouselItems.length;
          showSlide(currentSlide);
        } catch (error) {
          logError(error, "prevSlide");
          showMessage(
            "An error occurred while navigating to the previous slide. Please try again."
          );
        }
      });

      document.querySelectorAll(".fixed.inset-0").forEach((modal) => {
        modal.addEventListener("click", function (event) {
          if (event.target === this && this.id !== "nameModal") {
            closeModal(this.id);
          }
        });
      });

      howToPlayBtn.addEventListener("click", () =>
        openModal("instructionsModal")
      );
      howToPlayBtnMobile.addEventListener("click", () =>
        openModal("instructionsModal")
      );
      document
        .getElementById("close-instructions")
        .addEventListener("click", () => closeModal("instructionsModal"));

      // Initialize the game
      startGame();
    </script>
  </body>
</html>
